00001AB2 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 10/01/2022 19:01:30

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : GAME OF LIFE APPLICATION
00000000                             3  ; AUTHOR   : ANTONI BURGUERA
00000000                             4  ; CREATION : 05-JULY-2021
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"          ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; TITLE    : SYSTEM CONSTANTS
00001000                            14  ; AUTHOR   : ANTONI BURGUERA
00001000                            15  ; HISTORY  : 05-JULY-2021 - CREATION
00001000                            16  ; COMMENTS : * MOUVAL AND MOUEDGE FORMAT IS AS FOLLOWS:
00001000                            17  ;              +---+---+---+---+---+---+---+---+
00001000                            18  ;              | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            19  ;              +---+---+---+---+---+---+---+---+
00001000                            20  ;              \-------------------/ |   |   |
00001000                            21  ;                        |           |   |   +-- LEFT MOUSE BUTTON
00001000                            22  ;                        |           |   +------ RIGHT MOUSE BUTTON
00001000                            23  ;                        |           +---------- CENTRAL MOUSE BUTTON
00001000                            24  ;                        +---------------------- 0
00001000                            25  ;              A "1" IN ONE OF THESE BITS IN MOUVAL MEANS "BUTTON PRESSED".
00001000                            26  ;              A "0" IN ONE OF THESE BITS IN MOUVAL MEANS "BUTTON NOT PRESSED".
00001000                            27  ;              A "1" IN ONE OF THESE BITS IN MOUEDGE MEANS "BUTTON CLICKED".
00001000                            28  ;              A "0" IN ONE OF THESE BITS IN MOUEDGE MEANS "BUTTON NOT CLICKED".
00001000                            29  ;              A "CLICK" IS A CHANGE FROM 0 TO 1 IN SUBSEQUENT UPDATES.
00001000                            30  ;              BOTH MOUVEL AND MOUEDGE ARE UPDATED BY TRAP #MOUTRAP
00001000                            31  ;
00001000                            32  ;            * MASKS AND BIT POSITIONS ARE DEFINED TO EASE MOUSE ACCESS. FOR
00001000                            33  ;              EXAMPLE, ONE CAN DO THE FOLLOWING TO CHECK IF THE LEFT BUTTON
00001000                            34  ;              IS PRESSED:
00001000                            35  ;
00001000                            36  ;              BTST.L #MOUBITLF,(MOUVAL)
00001000                            37  ;              BNE ...
00001000                            38  ;
00001000                            39  ;              ALTERNATIVELY, ONE CAN ALSO DO THE FOLLOWING DEPENDING ON THE
00001000                            40  ;              CONTEXT:
00001000                            41  ;
00001000                            42  ;              MOVE.B  (MOUVAL),D0
00001000                            43  ;              AND.B   #MOUMSKLF,D0
00001000                            44  ;              BNE ...
00001000                            45  ; =============================================================================
00001000                            46  
00001000                            47  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            48  
00001000  =00000000                 49  SCRTRAP     EQU     0                       ; SCREEN REFRESH TRAP NUMBER
00001000  =00000320                 50  SCRWIDTH    EQU     800                     ; SCREEN WIDTH (PIXELS)
00001000  =00000258                 51  SCRHEIGH    EQU     600                     ; SCREEN HEIGHT (PIXELS)
00001000                            52  
00001000                            53  ; --- MOUSE RELATED CONSTANTS -------------------------------------------------
00001000                            54  
00001000  =00000001                 55  MOUTRAP     EQU     1                       ; MOUSE QUERY TRAP NUMBER
00001000  =00000001                 56  MOUMSKLF    EQU     %00000001               ; LEFT MOUSE BUTTON MASK
00001000  =00000002                 57  MOUMSKRT    EQU     %00000010               ; RIGHT MOUSE BUTTON MASK
00001000  =00000004                 58  MOUMSKMD    EQU     %00000100               ; MIDDLE MOUSE BUTTON MASL
00001000  =00000000                 59  MOUBITLF    EQU     0                       ; LEFT MOUSE BUTTON BIT POSITION
00001000  =00000001                 60  MOUBITRT    EQU     1                       ; RIGHT MOUSE BUTTON BIT POSITION
00001000  =00000002                 61  MOUBITMD    EQU     2                       ; MIDDLE MOUSE BUTTON BIT POSITION
00001000  =00000002                 62  -------------------- end include --------------------
00001000                            63              INCLUDE "SYSTEM.X68"            ; SYSTEM CODE
00001000                            64  ; =============================================================================
00001000                            65  ; TITLE    : SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            66  ; AUTHOR   : ANTONI BURGUERA
00001000                            67  ; HISTORY  : 05-JULY-2021 - CREATION
00001000                            68  ; COMMENTS : IT IS DIVIDED IN THREE BLOCKS:
00001000                            69  ;            - SYS : GENERIC.
00001000                            70  ;            - SCR : SCREEN MANAGEMENT.
00001000                            71  ;            - MOU : MOUSE MANAGEMENT
00001000                            72  ;            THE FORMAT OF MOUVAL AND MOUEDGE IS DESCRIBED IN SYSCONST.
00001000                            73  ; =============================================================================
00001000                            74  
00001000                            75  ; -----------------------------------------------------------------------------
00001000                            76  SYSINIT
00001000                            77  ; INITIALIZES THE SYSTEM AS FOLLOWS:
00001000                            78  ; * DISABLES INTERRUPTS
00001000                            79  ; * CALLS SCRINIT
00001000                            80  ; * CALLS MOUINIT
00001000                            81  ; * ENABLES SIMULATOR EXCEPTION PROCESSING
00001000                            82  ; * SWITCHES TO USER
00001000                            83  ; INPUT    - NONE
00001000                            84  ; OUTPUT   - NONE
00001000                            85  ; MODIFIES - NONE
00001000                            86  ; NOTE     - NOTE THAT INTERRUPTS REMAIN DISABLED AFTER THIS SUBROUTINE
00001000                            87  ; -----------------------------------------------------------------------------
00001000                            88  
00001000                            89  ; TODO : PLACE YOUR CODE HERE
00001000  40E7                      90      MOVE.W SR,-(A7)
00001002                            91      
00001002  0257 DFFF                 92      AND.W    #$DFFF,(A7)
00001006                            93      ;Desabilitamos interrupciones
00001006  0057 0700                 94      ORI.W    #$0700,(A7)
0000100A                            95      ;Guardamos los registros
0000100A  48E7 C000                 96      MOVEM.L D0-D1,-(A7)
0000100E                            97      
0000100E                            98      
0000100E                            99      
0000100E                           100      ;Llamamos a las subrutinas
0000100E  4EB9 0000108A            101      JSR SCRINIT
00001014  4EB9 0000102A            102      JSR MOUINIT
0000101A                           103      
0000101A                           104      ;activamos el simulador de excepciones
0000101A  103C 0020                105      MOVE.B #32,D0
0000101E  123C 0005                106      MOVE.B #5,D1
00001022  4E4F                     107      TRAP #15
00001024                           108      
00001024                           109      ;cambiamos a modo usuario
00001024                           110      
00001024  4CDF 0003                111      MOVEM.L (A7)+,D0-D1
00001028  4E73                     112      RTE
0000102A                           113  
0000102A                           114  
0000102A                           115  
0000102A                           116  
0000102A                           117  
0000102A                           118  
0000102A                           119  
0000102A                           120  
0000102A                           121  ; =============================================================================
0000102A                           122  ; MOUSE MANAGEMENT (SYSTEM CODE)
0000102A                           123  ; =============================================================================
0000102A                           124  
0000102A                           125  ; -----------------------------------------------------------------------------
0000102A                           126  MOUINIT
0000102A                           127  ; INITIALIZES MOUSE AS FOLLOWS:
0000102A                           128  ; * STORES CURRENT MOUSE POSITION AND BUTTON STATUS INTO MOUY, MOUX AND MOUVAL
0000102A                           129  ; * CLEARS MOUEDGE
0000102A                           130  ; * INSTALLS MOUREAD INTO TRAP #MOUTRAP
0000102A                           131  ; INPUT    - NONE
0000102A                           132  ; OUTPUT   - NONE
0000102A                           133  ; MODIFIES - ALL REGISTERS CAN BE MODIFIED
0000102A                           134  ; -----------------------------------------------------------------------------
0000102A                           135  
0000102A                           136  ; TODO : PLACE YOUR CODE HERE
0000102A                           137  
0000102A                           138      ;Guardamos los registros
0000102A  48E7 C000                139      MOVEM.L D0-D1,-(A7)
0000102E                           140  
0000102E                           141      ;Posición actual del mouse        
0000102E  103C 003D                142      MOVE.B #61,D0
00001032  4201                     143      CLR.B D1
00001034  4E4F                     144      TRAP #15
00001036                           145      
00001036                           146      ;Guardamos los valores
00001036  23C1 00001ACC            147      MOVE.L  D1,(MOUY)
0000103C                           148      
0000103C  13C0 00001AD0            149      MOVE.B D0,(MOUVAL)
00001042                           150      
00001042                           151      ;Reestablecemos MOUEDGE
00001042  13FC 0000 00001AD1       152      MOVE.B #0,(MOUEDGE)
0000104A                           153      
0000104A                           154      ;Instalamos MOUTRAP 
0000104A  21FC 00001058 0084       155      MOVE.L  #MOUREAD,($80+MOUTRAP*4)
00001052                           156      
00001052  4CDF 0003                157      MOVEM.L (A7)+,D0-D1
00001056  4E75                     158      RTS
00001058                           159  
00001058                           160  ; -----------------------------------------------------------------------------
00001058                           161  MOUREAD
00001058                           162  ; MOUSE READING TRAP SERVICE ROUTINE. IT DOES THE FOLLOWING:
00001058                           163  ; * STORES CURRENT MOUSE POSITION INTO MOUY AND MOUX.
00001058                           164  ; * STORES CURRENT BUTTON STATUS INTO MOUVAL
00001058                           165  ; * COMPUTES AND STORES MOUEDGE
00001058                           166  ; INPUT    - NONE
00001058                           167  ; OUTPUT   - NONE
00001058                           168  ; MODIFIES - NONE
00001058                           169  ; -----------------------------------------------------------------------------
00001058                           170  
00001058                           171  ; TODO : PLACE YOUR CODE HERE
00001058                           172  
00001058  48E7 C000                173      MOVEM.L D0-D1, -(A7)
0000105C                           174  
0000105C                           175      ;OBTENIM POSICIO RATOLI
0000105C  103C 003D                176      MOVE.B #61,D0
00001060  4201                     177      CLR.B D1
00001062  4E4F                     178      TRAP #15
00001064                           179  
00001064  23C1 00001ACC            180      MOVE.L D1,(MOUY)
0000106A  4639 00001AD0            181      NOT.B MOUVAL
00001070  1200                     182      MOVE.B D0,D1
00001072  C239 00001AD0            183      AND.B MOUVAL,D1
00001078  13C1 00001AD1            184      MOVE.B D1, (MOUEDGE)
0000107E  13C0 00001AD0            185      MOVE.B D0, (MOUVAL)
00001084                           186  
00001084                           187  
00001084                           188      ;RESTAURAM I TORNAM
00001084  4CDF 0003                189      MOVEM.L (A7)+, D0-D1
00001088  4E73                     190      RTE
0000108A                           191  
0000108A                           192  
0000108A                           193      
0000108A                           194  
0000108A                           195  
0000108A                           196  
0000108A                           197  
0000108A                           198  
0000108A                           199  
0000108A                           200  
0000108A                           201  
0000108A                           202  
0000108A                           203  ; =============================================================================
0000108A                           204  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000108A                           205  ; =============================================================================
0000108A                           206  
0000108A                           207  ; -----------------------------------------------------------------------------
0000108A                           208  SCRINIT
0000108A                           209  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS AS FOLLOWS:
0000108A                           210  ; * INSTALLS SCRUPD INTO TRAP #SCRTRAP
0000108A                           211  ; * SETS OUTPUT RESOLUTION TO SCRWIDTH*SCRHEIGH
0000108A                           212  ; * SETS OUTPUT TO WINDOWED MODE
0000108A                           213  ; * ENABLES DOUBLE BUFFER AND CLEARS BOTH SCREEN BUFFERS
0000108A                           214  ; INPUT    - NONE
0000108A                           215  ; OUTPUT   - NONE
0000108A                           216  ; MODIFIES - ALL REGISTERS CAN BE MODIFIED
0000108A                           217  ; -----------------------------------------------------------------------------
0000108A  21FC 000010C2 0080       218              MOVE.L  #SCRUPD,($80+SCRTRAP*4) ; INSTALL TRAP
00001092  223C 03200258            219              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1 ; SET RESOLUTION
00001098  103C 0021                220              MOVE.B  #33,D0
0000109C  4E4F                     221              TRAP    #15
0000109E  7201                     222              MOVE.L  #1,D1                   ; SET WINDOWED MODE
000010A0  4E4F                     223              TRAP    #15
000010A2  323C FF00                224              MOVE.W  #$FF00,D1               ; CLEAR VISIBLE BUFFER
000010A6  103C 000B                225              MOVE.B  #11,D0
000010AA  4E4F                     226              TRAP    #15
000010AC  123C 0011                227              MOVE.B  #17,D1                  ; ENABLE DOUBLE BUFFER
000010B0  103C 005C                228              MOVE.B  #92,D0
000010B4  4E4F                     229              TRAP    #15
000010B6  323C FF00                230              MOVE.W  #$FF00,D1               ; CLEAR HIDDEN BUFFER
000010BA  103C 000B                231              MOVE.B  #11,D0
000010BE  4E4F                     232              TRAP    #15
000010C0  4E75                     233              RTS
000010C2                           234  
000010C2                           235  ; -----------------------------------------------------------------------------
000010C2                           236  SCRUPD
000010C2                           237  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
000010C2                           238  ; BUFFER FOR THE NEXT ONE. PERFORMS TWO TASKS:
000010C2                           239  ; * CLEARS ACTIVE (HIDDEN) GRAPHICS BUFFER
000010C2                           240  ; * SWITCHES ACTIVE AND VISIBLE GRAPHICS BUFFER
000010C2                           241  ; INPUT    - NONE
000010C2                           242  ; OUTPUT   - NONE
000010C2                           243  ; MODIFIES - NONE
000010C2                           244  ; -----------------------------------------------------------------------------
000010C2  48A7 C000                245              MOVEM.W D0-D1,-(A7)
000010C6  103C 005E                246              MOVE.B  #94,D0                  ; UPDATE DOUBLE BUFFER
000010CA  4E4F                     247              TRAP    #15
000010CC  323C FF00                248              MOVE.W  #$FF00,D1               ; CLEAR HIDDEN BUFFER
000010D0  103C 000B                249              MOVE.B  #11,D0
000010D4  4E4F                     250              TRAP    #15
000010D6  4C9F 0003                251              MOVEM.W (A7)+,D0-D1
000010DA  4E73                     252              RTE
000010DC                           253  
000010DC                           254  
000010DC                           255  
000010DC                           256  
000010DC                           257  
000010DC                           258  
000010DC                           259  
000010DC                           260  
000010DC                           261  
000010DC                           262  
000010DC                           263  
000010DC                           264  -------------------- end include --------------------
000010DC                           265              INCLUDE "CONST.X68"             ; USER CONSTANTS
000010DC                           266  ; =============================================================================
000010DC                           267  ; TITLE    : USER CONSTANTS
000010DC                           268  ; AUTHOR   : ANTONI BURGUERA
000010DC                           269  ; HISTORY  : 05-JULY-2021 - CREATION
000010DC                           270  ; COMMENTS : * MOST OF THE CONSTANTS HELP IN PRODUCING A CLEAN CODE
000010DC                           271  ;              IN ACCORDANCE TO THE ASSIGNMENT SPECS, THOUGH THEIR USE IS
000010DC                           272  ;              NOT MANDATORY AS LONG AS THE ASSIGNMENT SPECS ARE FOLLOWED.
000010DC                           273  ;
000010DC                           274  ;            * THE UICOLORS ARE THE BASIC USER INTERFACE COLORS. USING THEM
000010DC                           275  ;              WILL LEAD TO A VISUALLY CONSISTENT USER INTERFACE.
000010DC                           276  ;
000010DC                           277  ;            * THE CHARACTER SIZES SPECIFY WIDTH AND HEIGHT IN PIXELS OF THE
000010DC                           278  ;              TEXT CHARACTERS. THIS SIZE DEPENDS ON THE SYSTEM (WINDOWS) FONTS
000010DC                           279  ;              AND CAN CHANGE FROM ONE COMPUTER TO ANOTHER. FEEL FREE TO ADAPT
000010DC                           280  ;              THEM TO YOUR OWN COMPUTER.
000010DC                           281  ;
000010DC                           282  ;            * CHARACTER SIZES ARE SPECIFIED AS AN EXPONENT AND THE SIZE ITSELF
000010DC                           283  ;              THE EXPONENT IS USEFUL TO MULTIPLY/DIVIDE, WHEN NECESSARY,
000010DC                           284  ;              USING SHIFTS. DEPENDING ON YOUR SYSTEM (WINDOWS) FONTS, CHAR
000010DC                           285  ;              SIZES MAY NOT BE POWER OF TWO. IF THIS IS THE CASE, DO YOUR BEST
000010DC                           286  ;              TO AVOID MULU AND DIVU.
000010DC                           287  ;
000010DC                           288  ;            * MOST OF THE GRD CONSTANTS ARE EXPRESSIONS TO EASE TESTING
000010DC                           289  ;              DIFFERENT RESOLUTIONS. IF TESTS WITH OTHER RESOLUTIONS ARE
000010DC                           290  ;              PERFORMED, TAKE INTO ACCOUNT THAT ALL EXPRESSIONS MUST EVALUATE
000010DC                           291  ;              TO INTEGER. IF THEY DON'T, UNEXPECTED RESULTS CAN HAPPEN.
000010DC                           292  ; =============================================================================
000010DC                           293  
000010DC                           294  ; --- UI COLORS ---------------------------------------------------------------
000010DC                           295  
000010DC  =00000000                296  CLRBLACK    EQU     $00000000               ; BLACK
000010DC  =00FFFFFF                297  CLRWHITE    EQU     $00FFFFFF               ; WHITE
000010DC  =00005500                298  CLRDKGRN    EQU     $00005500               ; DARK GREEN
000010DC  =00006600                299  CLRMDGRN    EQU     $00006600               ; MEDIUN GREEN
000010DC  =0000AA00                300  CLRLTGRN    EQU     $0000AA00               ; LIGHT GREEN
000010DC  =00FF0000                301  CLRLTBLU    EQU     $00FF0000               ; LIGHT BLUE
000010DC  =000000FF                302  CLRLTRED    EQU     $000000FF               ; LIGHT RED
000010DC                           303  
000010DC                           304  ; --- CHARACTER SIZES ---------------------------------------------------------
000010DC                           305  
000010DC  =00000004                306  CHRSHHEI    EQU     4                       ; CHARACTER HEIGHT AS EXPONENT OF 2
000010DC  =00000003                307  CHRSHWID    EQU     3                       ; CHARACTER WIDTH AS EXPONENT OF 2
000010DC  =00000010                308  CHRHEIGH    EQU     1<<CHRSHHEI             ; CHARACTER HEIGHT
000010DC  =00000008                309  CHRWIDTH    EQU     1<<CHRSHWID             ; CHARACTER WIDTH
000010DC                           310  
000010DC                           311  ; --- BUTTON ------------------------------------------------------------------
000010DC                           312  
000010DC  =00000004                313  BTNPENWD    EQU     4                       ; BUTTON LINE WIDTH
000010DC  =00005500                314  BTNPENCL    EQU     CLRDKGRN                ; BUTTON LINE COLOR
000010DC  =0000AA00                315  BTNSELCL    EQU     CLRLTGRN                ; BUTTON SELECTED FILL COLOR
000010DC  =00006600                316  BTNPRSCL    EQU     CLRMDGRN                ; BUTTON PRESSED FILL COLOR
000010DC  =00000006                317  BTNSZVDB    EQU     6                       ; SIZE (BYTES) OF VDB
000010DC                           318  
000010DC                           319  ; --- BUTTON LIST -------------------------------------------------------------
000010DC                           320  
000010DC  =0000000A                321  BTLMXVDB    EQU     10                      ; SIZE OF THE BUTTON LIST (ITEMS)
000010DC  =00000028                322  BTLVERSZ    EQU     40                      ; HEIGHT OF BUTTONS
000010DC  =0000000A                323  BTLVEMRG    EQU     10                      ; VERTICAL VISUAL MARGIN (TOP&BOT)
000010DC  =0000000A                324  BTLHOMRG    EQU     10                      ; HORIZONTAL VISUAL MARGIN (L & R)
000010DC                           325  
000010DC                           326  ; --- APPLICATION -------------------------------------------------------------
000010DC                           327  
000010DC  =00000000                328  GOLSPAUS    EQU     0                       ; PAUSED STATE
000010DC  =00000001                329  GOLSEXEC    EQU     1                       ; EXECUTION STATE
000010DC  =000000FA                330  GOLMAXGN    EQU     250                     ; MAXIMUM NUMBER OF GENERATIONS
000010DC                           331  
000010DC                           332  ; --- GRID --------------------------------------------------------------------
000010DC                           333  
000010DC  =00FF0000                334  GRDCOLP1    EQU     CLRLTBLU                ; PLAYER 1 COLOR
000010DC  =000000FF                335  GRDCOLP2    EQU     CLRLTRED                ; PLAYER 2 COLOR
000010DC  =00000006                336  GRDSHWID    EQU     6                       ; SHIFT TO ACHIEVE GRDWIDTH
000010DC  =00000005                337  GRDSHHEI    EQU     5                       ; SHIFT TO ACHIEVE GRDHEIGH
000010DC  =00000040                338  GRDWIDTH    EQU     1<<GRDSHWID             ; NUMBER OF GRID COLUMNS
000010DC  =00000020                339  GRDHEIGH    EQU     1<<GRDSHHEI             ; NUMBER OF ROWS
000010DC  =0000003F                340  GRDMSWID    EQU     GRDWIDTH-1              ; MASK TO GET X FROM GRID OFFSET
000010DC  =0000001F                341  GRDMSHEI    EQU     GRDHEIGH-1              ; MASK TO GET Y FROM GRID OFFSET
000010DC  =00000300                342  GRDPXWID    EQU     768                     ; GRID DISPLAY WIDTH (PIXELS)
000010DC  =00000180                343  GRDPXHEI    EQU     GRDHEIGH*GRDPXWID/GRDWIDTH ; GRID DISPLAY HEIGHT (PIXELS)
000010DC  =0000000C                344  GRDSZCEL    EQU     GRDPXWID/GRDWIDTH       ; GRID CELL SIZE (PIXELS)
000010DC  =0000006E                345  GRDVEMRG    EQU     3*BTLVEMRG+2*BTLVERSZ   ; TOP MARGIN (2 BUTTON ROWS)
000010DC  =00000010                346  GRDXOFF     EQU     (SCRWIDTH-GRDPXWID)/2   ; X OFFSETS TO DISPLAY CENTERED GRID
000010DC  =0000009E                347  GRDYOFF     EQU     (SCRHEIGH-GRDPXHEI+GRDVEMRG-BTLVEMRG)/2 ; Y OFFSET CENT. GRD
000010DC  =00000002                348  GRDSCP1X    EQU     GRDXOFF/CHRWIDTH        ; PLAYER 1 SCORE X (CHAR RESOL.)
000010DC  =00000009                349  GRDSCP1Y    EQU     GRDYOFF/CHRHEIGH        ; PLAYER 1 SCORE Y (CHAR RESOL.)
000010DC  =0000005E                350  GRDSCP2X    EQU     (GRDXOFF+GRDPXWID)/CHRWIDTH-4 ; PLAYER 2 SCORE X (CHAR RES.)
000010DC  =00000009                351  GRDSCP2Y    EQU     GRDYOFF/CHRHEIGH        ; PLAYER 2 SCORE Y (CHAR RESOL.)
000010DC  =00000030                352  GRDSCNGX    EQU     (SCRWIDTH/(CHRWIDTH*2))-2 ; NUM. GENER. X (CHAR RESOL.)
000010DC  =00000009                353  GRDSCNGY    EQU     GRDYOFF/CHRHEIGH        ; NUM. GENER. Y (CHAR RESOL.)
000010DC  =00000009                354  -------------------- end include --------------------
000010DC                           355              INCLUDE "UTIL.X68"              ; UTILITY CODE
000010DC                           356  ; =============================================================================
000010DC                           357  ; TITLE    : UTILITY SUBROUTINES
000010DC                           358  ; AUTHOR   : ANTONI BURGUERA
000010DC                           359  ; HISTORY  : 05-JULY-2021 - CREATION
000010DC                           360  ; COMMENTS : GENERAL PURPOSE SUBROUTINES.
000010DC                           361  ; =============================================================================
000010DC                           362  
000010DC                           363  ; -----------------------------------------------------------------------------
000010DC                           364  UTLINIT
000010DC                           365  ; INITIALIZES UTILITIES.
000010DC                           366  ; INPUT    : NONE
000010DC                           367  ; OUTPUT   : NONE
000010DC                           368  ; MODIFIES : NONE
000010DC                           369  ; -----------------------------------------------------------------------------
000010DC  4239 00001AD2            370              CLR.B   (UTLRNDIX)
000010E2  4E75                     371              RTS
000010E4                           372  
000010E4                           373  ; -----------------------------------------------------------------------------
000010E4                           374  UTLSTRLN
000010E4                           375  ; COMPUTES THE LENGTH OF A ZERO-TERMINATED STRING
000010E4                           376  ; INPUT    - A1 POINTER TO THE STRING
000010E4                           377  ; OUTPUT   - D0.W STRING LENGTH
000010E4                           378  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010E4                           379  ; -----------------------------------------------------------------------------
000010E4  2F09                     380              MOVE.L  A1,-(A7)
000010E6  4240                     381              CLR.W   D0
000010E8  4A19                     382  .LOOP       TST.B   (A1)+
000010EA  6700 0006                383              BEQ     .END
000010EE  5240                     384              ADDQ.W  #1,D0
000010F0  60F6                     385              BRA     .LOOP
000010F2  225F                     386  .END        MOVE.L  (A7)+,A1
000010F4  4E75                     387              RTS
000010F6                           388  
000010F6                           389  ; -----------------------------------------------------------------------------
000010F6                           390  UTLRAND
000010F6                           391  ; PROVIDES A PSEUDO-RANDOM COIN FLIP (RETURNS 1 OR 2)
000010F6                           392  ; INPUT    - NONE
000010F6                           393  ; OUTPUT   - D1.L RANDOM VALUE (ONLY BYTE)
000010F6                           394  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000010F6                           395  ; -----------------------------------------------------------------------------
000010F6  2F08                     396              MOVE.L  A0,-(A7)
000010F8  41F9 00001114            397              LEA     .RANDVEC,A0
000010FE  4281                     398              CLR.L   D1
00001100  1239 00001AD2            399              MOVE.B  (UTLRNDIX),D1
00001106  1230 1800                400              MOVE.B  (A0,D1.L),D1
0000110A  5239 00001AD2            401              ADDQ.B  #1,(UTLRNDIX)
00001110  205F                     402              MOVE.L  (A7)+,A0
00001112  4E75                     403              RTS
00001114                           404  
00001114= 02 02 02 02 01 02 ...    405  .RANDVEC    DC.B    2, 2, 2, 2, 1, 2, 1, 2
0000111C= 01 01 01 02 01 01 ...    406              DC.B    1, 1, 1, 2, 1, 1, 1, 2
00001124= 02 01 02 01 01 02 ...    407              DC.B    2, 1, 2, 1, 1, 2, 2, 1
0000112C= 02 01 02 01 01 01 ...    408              DC.B    2, 1, 2, 1, 1, 1, 1, 2
00001134= 02 02 01 01 02 02 ...    409              DC.B    2, 2, 1, 1, 2, 2, 1, 1
0000113C= 02 01 02 02 02 01 ...    410              DC.B    2, 1, 2, 2, 2, 1, 1, 1
00001144= 02 02 01 01 01 01 ...    411              DC.B    2, 2, 1, 1, 1, 1, 1, 2
0000114C= 01 01 01 02 01 02 ...    412              DC.B    1, 1, 1, 2, 1, 2, 1, 2
00001154= 02 02 02 02 01 02 ...    413              DC.B    2, 2, 2, 2, 1, 2, 1, 2
0000115C= 01 01 02 02 02 01 ...    414              DC.B    1, 1, 2, 2, 2, 1, 2, 1
00001164= 02 02 02 01 01 02 ...    415              DC.B    2, 2, 2, 1, 1, 2, 1, 1
0000116C= 01 02 01 01 01 02 ...    416              DC.B    1, 2, 1, 1, 1, 2, 1, 2
00001174= 01 02 02 01 02 01 ...    417              DC.B    1, 2, 2, 1, 2, 1, 2, 2
0000117C= 01 02 01 02 01 01 ...    418              DC.B    1, 2, 1, 2, 1, 1, 2, 1
00001184= 01 02 01 01 01 01 ...    419              DC.B    1, 2, 1, 1, 1, 1, 1, 1
0000118C= 02 01 01 02 01 01 ...    420              DC.B    2, 1, 1, 2, 1, 1, 1, 2
00001194= 02 01 01 01 01 02 ...    421              DC.B    2, 1, 1, 1, 1, 2, 1, 1
0000119C= 01 01 02 01 01 02 ...    422              DC.B    1, 1, 2, 1, 1, 2, 1, 2
000011A4= 02 02 01 01 02 02 ...    423              DC.B    2, 2, 1, 1, 2, 2, 2, 2
000011AC= 01 01 02 01 02 02 ...    424              DC.B    1, 1, 2, 1, 2, 2, 1, 2
000011B4= 01 02 01 02 02 02 ...    425              DC.B    1, 2, 1, 2, 2, 2, 2, 1
000011BC= 01 01 02 02 01 01 ...    426              DC.B    1, 1, 2, 2, 1, 1, 2, 1
000011C4= 02 02 01 02 01 02 ...    427              DC.B    2, 2, 1, 2, 1, 2, 1, 1
000011CC= 02 01 02 01 01 02 ...    428              DC.B    2, 1, 2, 1, 1, 2, 1, 2
000011D4= 01 01 02 02 02 01 ...    429              DC.B    1, 1, 2, 2, 2, 1, 1, 1
000011DC= 01 01 02 02 01 02 ...    430              DC.B    1, 1, 2, 2, 1, 2, 1, 2
000011E4= 01 02 01 01 01 02 ...    431              DC.B    1, 2, 1, 1, 1, 2, 1, 1
000011EC= 02 01 01 02 01 02 ...    432              DC.B    2, 1, 1, 2, 1, 2, 2, 2
000011F4= 02 01 01 01 02 02 ...    433              DC.B    2, 1, 1, 1, 2, 2, 1, 1
000011FC= 02 02 02 01 02 02 ...    434              DC.B    2, 2, 2, 1, 2, 2, 1, 2
00001204= 01 02 01 01 02 01 ...    435              DC.B    1, 2, 1, 1, 2, 1, 2, 2
0000120C= 02 02 02 01 01 01 ...    436              DC.B    2, 2, 2, 1, 1, 1, 1, 2
0000120C= 02 02 02 01 01 01 ...    437  -------------------- end include --------------------
00001214                           438              INCLUDE "BUTTON.X68"            ; BUTTON MANAGEMENT
00001214                           439  ; =============================================================================
00001214                           440  ; TITLE    : BUTTON MANAGEMENT
00001214                           441  ; AUTHOR   : ANTONI BURGUERA
00001214                           442  ; HISTORY  : 05-JULY-2021 - CREATION
00001214                           443  ; COMMENTS : * A BUTTON IS DEFINED BY A STATIC DATA BLOCK (SDB), WHICH DOES NOT
00001214                           444  ;              CHANGE OVER TIME, AND A VARIABLE DATA BLOCK (VDB), THAT CAN
00001214                           445  ;              CHANGE OVER TIME. CHANGES IN THE VDB ARE PRODUCED WHEN CALLING
00001214                           446  ;              SUBROUTINE BTNUPD.
00001214                           447  ;
00001214                           448  ;            * THE BUTTON SDB (CAN BE IN ROM) HAS THE FOLLOWING FIELDS. THE
00001214                           449  ;              NUMBER DENOTES THE OFFSET WITH RESPECT TO THE SDB START:
00001214                           450  ;
00001214                           451  ;                +0  - WORD - YTOP COORDINATE (PIXELS)
00001214                           452  ;                +2  - WORD - XLEFT COORDINATE (PIXELS)
00001214                           453  ;                +4  - WORD - HEIGHT (PIXELS)
00001214                           454  ;                +6  - WORD - WIDTH (PIXELS)
00001214                           455  ;                +8  - LONG - CALLBACK POINTER
00001214                           456  ;                +12 - BYTE STRING - ZERO TERMINATED STRING. TEXT TO SHOW.
00001214                           457  ;
00001214                           458  ;            * THE BUTTON VDB (MUST BE IN RAM) IS:
00001214                           459  ;
00001214                           460  ;                +0 - LONG - POINTER TO THE STATIC DATABLOCK
00001214                           461  ;                +4 - BYTE - STATUS WITH FORMAT XXXXXCPI WHERE:
00001214                           462  ;                            - I (BIT 0) - 1=MOUSE INSIDE, 0=MOUSE OUTSIDE
00001214                           463  ;                            - P (BIT 1) - 1=MOUSE PRESSED INSIDE
00001214                           464  ;                                          0=MOUSE NOT PRESSED INSIDE
00001214                           465  ;                            - C (BIT 2) - 1=MOUSE CLICKED INSIDE
00001214                           466  ;                                          0=MOUSE NOT CLICKED INSIDE
00001214                           467  ;                            NOTE THAT IF I=0 THEN P=C=0, IF I=1 AND P=0
00001214                           468  ;                            THEN C=0.
00001214                           469  ; =============================================================================
00001214                           470  
00001214                           471  ; -----------------------------------------------------------------------------
00001214                           472  BTNINIT
00001214                           473  ; INITIALIZES THE BUTTON BY:
00001214                           474  ;  * COPYING THE SDB POINTER INTO THE VDB.
00001214                           475  ;  * CLEARING THE STATUS BYTE.
00001214                           476  ; INPUT    : A0 - POINTER TO THE VARIABLE DATABLOCK
00001214                           477  ;            A1 - POINTER TO THE STATIC DATABLOCK
00001214                           478  ; OUTPUT   : NONE
00001214                           479  ; MODIFIES : NONE
00001214                           480  ; -----------------------------------------------------------------------------
00001214                           481  
00001214                           482  ; TODO : PLACE YOUR CODE HERE  
00001214                           483  
00001214                           484              ;Copiamos SDB (A1) en el contenido de VDB ((A0))         
00001214  2089                     485              MOVE.L A1,(A0)
00001216                           486              
00001216                           487              ;Limpiamos el B status
00001216  4228 0004                488              CLR.B 4(A0) 
0000121A                           489             
0000121A  4E75                     490              RTS
0000121C                           491  ; -----------------------------------------------------------------------------
0000121C                           492  BTNUPD
0000121C                           493  ; UPDATES THE BUTTON VDB AND EXECUTES THE CALLBACK IF REQUIRED
0000121C                           494  ; INPUT    : A0 - POINTER TO THE VARIABLE DATABLOCK
0000121C                           495  ; OUTPUT   : NONE
0000121C                           496  ; MODIFIES : NONE
0000121C                           497  ; -----------------------------------------------------------------------------
0000121C                           498  
0000121C                           499  ; TODO : PLACE YOUR CODE HERE
0000121C                           500           
0000121C                           501  
0000121C  48E7 F0F0                502      MOVEM.L A0-A3/D0-D3, -(A7)
00001220                           503  
00001220                           504      ;A1-SDB +0
00001220  2250                     505      MOVE.L (A0),A1
00001222                           506  
00001222  5888                     507      ADDQ.L #4,A0
00001224                           508  
00001224                           509      ;A0 APUNTA A VBD +4 STATTUS I POSAM ELS BITS CPI A 0
00001224  0210 00F8                510      ANDI.B #%11111000,(A0)
00001228                           511  
00001228                           512      ;MIRAR SI Y ES MAJOR QUE LA
00001228                           513      ;COORDENADA Y DEL BOTO
00001228                           514  
00001228                           515  
00001228                           516      ;TEMPORAL
00001228                           517      ;YTOP COORDINATES
00001228                           518      ;D1 - YTOP
00001228  3211                     519      MOVE.W (A1),D1
0000122A  3439 00001ACC            520      MOVE.W (MOUY),D2
00001230                           521  
00001230                           522      ;A1-HEIGHT
00001230                           523  
00001230  3629 0004                524      MOVE.W 4(A1),D3
00001234                           525  
00001234                           526  
00001234                           527  
00001234                           528      ;COMPARAM COORDENADES Y DEL RATOLI
00001234                           529      ;AMB ELS PIXELS Y DEL BOTO
00001234  9441                     530      SUB.W D1,D2
00001236                           531  
00001236                           532  
00001236                           533  
00001236                           534      ;MIRAM SI LA ANTERIOR DIFERENCIA ES MENOR QUE LA ALTURA
00001236  B642                     535      CMP.W D2,D3
00001238  6C00 0032                536      BGE  .MAJOR_0_Y
0000123C                           537  
0000123C                           538  
0000123C  4EF9 000012B2            539      JMP .FINAL
00001242                           540  
00001242                           541  
00001242                           542  
00001242                           543   
00001242                           544  ;SABEMO QUE MOUY HA ESTAT MAJOR QUE LA
00001242                           545  ;COORDENADA Y DEL BOTO
00001242                           546  
00001242                           547  
00001242                           548  .DINS_Y:
00001242                           549  
00001242                           550      ;TEMPORAL
00001242                           551      ;YTOP COORDINATES
00001242                           552      ;D1 - YTOP
00001242                           553  
00001242                           554      ;A1-XLEFT
00001242  3229 0002                555      MOVE.W 2(A1),D1
00001246                           556  
00001246  3439 00001ACE            557      MOVE.W (MOUX),D2
0000124C                           558  
0000124C                           559  
0000124C                           560      ;A1-WIDTH
0000124C  3629 0006                561      MOVE.W 6(A1),D3
00001250                           562  
00001250                           563      ;COMPARAM COORDENADES x DEL RATOLI
00001250                           564      ;AMB ELS PIXELS x DEL BOTO
00001250  9441                     565      SUB.W D1,D2
00001252                           566  
00001252                           567      ;MIRAM SI LA ANTERIOR DIFERENCIA ES MENOR QUE LA
00001252                           568      ;AMPLADA
00001252  B642                     569      CMP.W D2,D3
00001254  6C00 0008                570      BGE  .MAJOR_0_X 
00001258  4EF9 000012B2            571      JMP .FINAL
0000125E                           572  
0000125E                           573  
0000125E                           574  .MAJOR_0_X:
0000125E  B47C 0000                575      CMP #0,D2
00001262  6C00 0014                576      BGE .BITI
00001266  4EF9 000012B2            577      JMP .FINAL
0000126C                           578  
0000126C                           579  .MAJOR_0_Y:
0000126C  B47C 0000                580      CMP #0,D2
00001270  6CD0                     581      BGE .DINS_Y
00001272  4EF9 000012B2            582      JMP .FINAL
00001278                           583  
00001278                           584  
00001278                           585  
00001278                           586  
00001278                           587  .BITI:
00001278                           588      ;ACTIVAM BIT I
00001278  0010 0001                589      ORI.B #%00000001,(A0)
0000127C                           590  
0000127C                           591      ;MOUSE STATUS A D1
0000127C                           592  
0000127C  1239 00001AD0            593      MOVE.B (MOUVAL),D1
00001282                           594      ;MIRAM BIT 0 PER VEURE SI EL CLICK ESQUERRE
00001282                           595      ;SE HA APRETAT PRESSED
00001282  0801 0000                596      BTST.L #0,D1
00001286                           597      ;SI HA ESTAT 1 BITP
00001286  6600 0008                598      BNE .BITP
0000128A                           599  
0000128A                           600  
0000128A  4EF9 000012B2            601      JMP .FINAL
00001290                           602  
00001290                           603  
00001290                           604  .BITP: 
00001290                           605      ;ACTIVAM EL BIT P
00001290  0010 0002                606      ORI.B #%0000010,(A0)
00001294                           607      ;MIRAM BIT 0 PER VEURE SI EL BOTO ESQUERRE
00001294                           608      ;SE HA APRETAT PRESSED
00001294  1239 00001AD1            609      MOVE.B (MOUEDGE),D1
0000129A  0801 0000                610      BTST.L #0,D1
0000129E                           611  
0000129E                           612      ;SI HA ESTAT 1 A BITC
0000129E  6600 0008                613      BNE .BITC
000012A2                           614  
000012A2                           615  
000012A2  4EF9 000012B2            616      JMP .FINAL
000012A8                           617  
000012A8                           618  
000012A8                           619  
000012A8                           620  .BITC:
000012A8                           621  
000012A8  0010 0004                622       ORI.B #%00000100,(A0)
000012AC  2469 0008                623       MOVE.L 8(A1),A2
000012B0                           624  
000012B0                           625       ;EXECUTES CALLBACK
000012B0  4E92                     626       JSR  (A2)
000012B2                           627  
000012B2                           628  
000012B2                           629  
000012B2                           630  
000012B2                           631  .FINAL:
000012B2                           632  
000012B2  4CDF 0F0F                633       MOVEM.L (A7)+,A0-A3/D0-D3 
000012B6  4E75                     634       RTS
000012B8                           635  
000012B8                           636  
000012B8                           637  
000012B8                           638  
000012B8                           639  
000012B8                           640  
000012B8                           641  
000012B8                           642  ; -----------------------------------------------------------------------------
000012B8                           643  BTNPLOT
000012B8                           644  ; PLOTS THE BUTTON. A RECTANGLE IS DRAWN WITH THICKNESS BTNPENWD. THE CONTOUR
000012B8                           645  ; COLOR IS BTNPENCL. THE FILL COLOR IS BLACK IF THE MOUSE IS NOT INSIDE,
000012B8                           646  ; BTNSELCL IF THE MOUSE IS INSIDE BUT THE MOUSE BUTTON IS NOT PRESSED AND
000012B8                           647  ; BTNPRSCL IF THE MOUSE BUTTON IS PRESSED INSIDE.
000012B8                           648  ; INPUT    : A0 - POINTER TO THE VARIABLE DATABLOCK
000012B8                           649  ; OUTPUT   : NONE
000012B8                           650  ; MODIFIES : NONE
000012B8                           651  ; -----------------------------------------------------------------------------
000012B8                           652  
000012B8                           653  ; TODO : PLACE YOUR CODE HERE
000012B8                           654  
000012B8  48E7 FFC0                655          MOVEM.L D0-D7/A0-A1,-(A7)
000012BC  103C 005D                656          MOVE.B #93,D0
000012C0  123C 0004                657          MOVE.B #BTNPENWD,D1
000012C4  4E4F                     658          TRAP #15
000012C6                           659          
000012C6  103C 0050                660          MOVE.B #80,D0
000012CA  223C 00005500            661          MOVE.L #BTNPENCL,D1
000012D0  4E4F                     662          TRAP #15
000012D2                           663          
000012D2  1628 0004                664          MOVE.B 4(A0),D3
000012D6  0803 0000                665          BTST.L #0,D3
000012DA  6600 0008                666          BNE INSIDE
000012DE                           667          
000012DE  4EF9 00001310            668          JMP OUT
000012E4                           669  
000012E4  0803 0001                670  INSIDE: BTST.L #1,D3
000012E8  6600 0014                671          BNE PRESSED
000012EC  103C 0051                672          MOVE.B #81,D0
000012F0  223C 0000AA00            673          MOVE.L #BTNSELCL,D1
000012F6  4E4F                     674          TRAP #15
000012F8                           675          
000012F8  4EF9 00001318            676          JMP FINAL1
000012FE                           677  
000012FE  103C 0051                678  PRESSED: MOVE.B #81,D0
00001302  223C 00006600            679           MOVE.L #BTNPRSCL,D1
00001308  4E4F                     680           TRAP #15
0000130A                           681           
0000130A  4EF9 00001318            682           JMP FINAL1
00001310                           683           
00001310  103C 0051                684  OUT:     MOVE.B #81,D0
00001314  7200                     685           MOVE.L #0,D1
00001316  4E4F                     686           TRAP #15
00001318                           687  
00001318                           688  
00001318  2250                     689  FINAL1:  MOVE.L (A0),A1
0000131A                           690           
0000131A  103C 0057                691           MOVE.B #87,D0
0000131E  3229 0002                692           MOVE.W 2(A1),D1
00001322  3411                     693           MOVE.W (A1),D2
00001324  3601                     694           MOVE.W D1,D3
00001326  D669 0006                695           ADD.W 6(A1),D3
0000132A  3802                     696           MOVE.W D2,D4
0000132C  D869 0004                697           ADD.W 4(A1),D4
00001330  4E4F                     698           TRAP #15
00001332                           699           
00001332  103C 005F                700           MOVE.B #95,D0
00001336  3229 0002                701           MOVE.W 2(A1),D1
0000133A  0641 0028                702           ADD.W #40,D1
0000133E                           703           
0000133E  3411                     704           MOVE.W (A1),D2
00001340  0642 000F                705           ADD.W #15,D2
00001344                           706           
00001344  D2FC 000C                707           ADD.W #12,A1
00001348                           708           
00001348  4E4F                     709           TRAP #15
0000134A                           710           
0000134A  4CDF 03FF                711           MOVEM.L (A7)+,D0-D7/A0-A1
0000134E                           712  
0000134E  4E75                     713           RTS
00001350                           714  
00001350                           715  
00001350                           716  
00001350                           717  
00001350                           718  
00001350                           719  
00001350                           720  
00001350                           721  
00001350                           722  
00001350                           723  
00001350                           724  
00001350                           725  
00001350                           726  
00001350                           727  
00001350                           728  
00001350                           729  
00001350                           730  
00001350                           731  
00001350                           732  
00001350                           733  
00001350                           734  -------------------- end include --------------------
00001350                           735              INCLUDE "BTNLIST.X68"           ; BUTTON LIST MANAGEMENT
00001350                           736  ; =============================================================================
00001350                           737  ; TITLE    : BUTTON LIST MANAGEMENT
00001350                           738  ; AUTHOR   : ANTONI BURGUERA
00001350                           739  ; HISTORY  : 05-JULY-2021 - CREATION
00001350                           740  ; COMMENTS : * ALLOWS ADDING, UPDATING AND PLOTTING A LIST OF BUTTONS. ALLOWS
00001350                           741  ;              REMOVING THEM ALL, BUT NOT INDIVIDUALLY.
00001350                           742  ;
00001350                           743  ;            * THE LIST OF BUTTONS IS STORED AS A LIST OF BUTTON'S VDB. THIS
00001350                           744  ;              LIST IS STORED AT BTLDATA.
00001350                           745  ;
00001350                           746  ;            * THE LIST OF VBD IS BUILT ASSUMING A MAXIMUM OF BTLMXVDB BUTTONS
00001350                           747  ;              AND A SIZE OF BTNSZVDB BYTES FOR EACH VDB.
00001350                           748  ; =============================================================================
00001350                           749  
00001350                           750  ; -----------------------------------------------------------------------------
00001350                           751  BTLINIT
00001350                           752  ; INITIALIZES BUTTON LIST BY SETTING ALL THE POINTERS TO STATIC DATA BLOCKS
00001350                           753  ; TO $FFFFFFFF.
00001350                           754  ; INPUT    : NONE
00001350                           755  ; OUTPUT   : NONE
00001350                           756  ; MODIFIES : NONE
00001350                           757  ; -----------------------------------------------------------------------------
00001350  48E7 8080                758              MOVEM.L D0/A0,-(A7)
00001354  41F9 00001AD4            759              LEA     BTLDATA,A0
0000135A  303C 0009                760              MOVE.W  #BTLMXVDB-1,D0          ; NUM ITERATIONS
0000135E  20BC FFFFFFFF            761  .LOOP       MOVE.L  #$FFFFFFFF,(A0)         ; MARK SLOT AS EMPTY
00001364  5C88                     762              ADD.L   #BTNSZVDB,A0            ; GO TO NEXT SLOT
00001366  51C8 FFF6                763              DBRA.W  D0,.LOOP                ; LOOP FOR ALL SLOTS
0000136A  4CDF 0101                764              MOVEM.L (A7)+,D0/A0
0000136E  4E75                     765              RTS
00001370                           766  
00001370                           767  ; -----------------------------------------------------------------------------
00001370  =00001350                768  BTLCLEAR    EQU     BTLINIT
00001370                           769  ; CLEARS THE BUTTON LIST. SAME AS BTLINIT.
00001370                           770  ; INPUT    : NONE
00001370                           771  ; OUTPUT   : NONE
00001370                           772  ; MODIFIES : NONE
00001370                           773  ; -----------------------------------------------------------------------------
00001370                           774  
00001370                           775  ; -----------------------------------------------------------------------------
00001370                           776  BTLADD
00001370                           777  ; ADDS A NEW BUTTON INTO THE BUTTON LIST AND INITS IT.
00001370                           778  ; INPUT    : A1 - POINTER TO THE BUTTON SDB
00001370                           779  ; OUTPUT   : NONE
00001370                           780  ; MODIFIES : NONE
00001370                           781  ; -----------------------------------------------------------------------------
00001370  48E7 8080                782              MOVEM.L A0/D0,-(A7)
00001374                           783  
00001374                           784              ; SEARCH FOR AN EMPTY SLOT
00001374                           785  
00001374  41F9 00001AD4            786              LEA     BTLDATA,A0
0000137A  303C 0009                787              MOVE.W  #BTLMXVDB-1,D0
0000137E  0C90 FFFFFFFF            788  .LOOP       CMP.L   #$FFFFFFFF,(A0)
00001384  6700 000E                789              BEQ     .FOUND
00001388  5C88                     790              ADD.L   #BTNSZVDB,A0
0000138A  51C8 FFF2                791              DBRA.W  D0,.LOOP
0000138E                           792  
0000138E                           793              ; NO SLOT? DO NOTHING
0000138E                           794  
0000138E  4CDF 0101                795  .END        MOVEM.L (A7)+,A0/D0
00001392  4E75                     796              RTS
00001394                           797  
00001394                           798              ; SLOT FOUND? PLACE THE BUTTON THERE BY CALLING BTNINIT
00001394                           799  
00001394  4EB8 1214                800  .FOUND      JSR     BTNINIT
00001398  60F4                     801              BRA     .END
0000139A                           802  
0000139A                           803  ; -----------------------------------------------------------------------------
0000139A                           804  BTLUPD
0000139A                           805  ; CALLS BTNUPD FOR ALL THE BUTTONS IN THE BUTTON LIST.
0000139A                           806  ; INPUT    : NONE
0000139A                           807  ; OUTPUT   : NONE
0000139A                           808  ; MODIFIES : NONE
0000139A                           809  ; -----------------------------------------------------------------------------
0000139A                           810  
0000139A  48E7 8080                811              MOVEM.L A0/D0,-(A7)
0000139E                           812  
0000139E                           813              ; TRAVERSE THE LIST
0000139E                           814  
0000139E  41F9 00001AD4            815              LEA     BTLDATA,A0
000013A4  303C 0009                816              MOVE.W  #BTLMXVDB-1,D0
000013A8  0C90 FFFFFFFF            817  .LOOP       CMP.L   #$FFFFFFFF,(A0)
000013AE  6700 000C                818              BEQ     .DONE
000013B2                           819  
000013B2                           820              ; UPDATE EACH BUTTON
000013B2                           821  
000013B2  4EB8 121C                822              JSR     BTNUPD
000013B6                           823  
000013B6                           824              ; GO TO THE NEXT BUTTON
000013B6                           825  
000013B6  5C88                     826              ADD.L   #BTNSZVDB,A0
000013B8  51C8 FFEE                827              DBRA.W  D0,.LOOP
000013BC                           828  
000013BC  4CDF 0101                829  .DONE       MOVEM.L (A7)+,A0/D0
000013C0  4E75                     830              RTS
000013C2                           831  
000013C2                           832  
000013C2                           833  ; -----------------------------------------------------------------------------
000013C2                           834  BTLPLOT
000013C2                           835  ; CALLS BTNPLOT FOR ALL THE BUTTONS IN THE BUTTON LIST.
000013C2                           836  ; INPUT    : NONE
000013C2                           837  ; OUTPUT   : NONE
000013C2                           838  ; MODIFIES : NONE
000013C2                           839  ; -----------------------------------------------------------------------------
000013C2                           840  
000013C2                           841  ; TODO : PLACE YOUR CODE HERE
000013C2  48E7 8080                842              MOVEM.L A0/D0,-(A7)
000013C6                           843  
000013C6                           844              ;Recorremos la lista
000013C6  41F9 00001AD4            845              LEA     BTLDATA,A0
000013CC  303C 0009                846              MOVE.W  #BTLMXVDB-1,D0
000013D0  0C90 FFFFFFFF            847  .LOOP       CMP.L   #$FFFFFFFF,(A0)
000013D6  6700 000C                848              BEQ     .FIN
000013DA                           849  
000013DA                           850              ;Actualizamos el botón
000013DA  4EB8 12B8                851              JSR     BTNPLOT
000013DE                           852  
000013DE                           853              ;Siguiente botón
000013DE  5C88                     854              ADD.L   #BTNSZVDB,A0
000013E0                           855              
000013E0                           856              ;Volvemos al bucle para los otros botones
000013E0  51C8 FFEE                857              DBRA  D0,.LOOP
000013E4                           858  
000013E4  4CDF 0101                859  .FIN        MOVEM.L (A7)+,A0/D0
000013E8  4E75                     860              RTS
000013EA                           861  
000013EA                           862  
000013EA                           863  
000013EA                           864  
000013EA                           865  
000013EA                           866  
000013EA                           867  
000013EA                           868  
000013EA                           869  
000013EA                           870  
000013EA                           871  
000013EA                           872  
000013EA                           873  
000013EA                           874  -------------------- end include --------------------
000013EA                           875              INCLUDE "GRID.X68"              ; GRID MANAGEMENT
000013EA                           876   ; =============================================================================
000013EA                           877  ; TITLE    : GRID MANAGEMENT
000013EA                           878  ; AUTHOR   : ANTONI BURGUERA
000013EA                           879  ; HISTORY  : 05-JULY-2021 - CREATION
000013EA                           880  ; COMMENTS : * THERE ARE TWO MATRICES (GRDMATR0 AND GRDMATR1) AND TWO POINTERS
000013EA                           881  ;              TO THESE MATRICES (GRDSRC AND GRDDST).
000013EA                           882  ;
000013EA                           883  ;            * THE MATRIX TO BE PLOTTED IS ALWAYS THE ONE POINTED BY GRDDST.
000013EA                           884  ;
000013EA                           885  ;            * THE MATRIX TO BE UPDATED BY THE MOUSE (GRDMUPD) IS ALWAYS THE
000013EA                           886  ;              ONE POINTED BY GRDDST.
000013EA                           887  ;
000013EA                           888  ;            * THE RULES-UPDATE (GRDRUPD) SWITCHES THE POINTERS AND THEN READS
000013EA                           889  ;              THE NEW SOURCE MATRIX (GRDSRC) TO DETERMINE THE NUMBER OF
000013EA                           890  ;              NEIGHBORS. THE RESULTING CELL VALUE IS WRITTEN TO THE DESTINA-
000013EA                           891  ;              TION MATRIX, POINTED BY GRDDST.
000013EA                           892  ; =============================================================================
000013EA                           893  
000013EA                           894  ; -----------------------------------------------------------------------------
000013EA                           895  GRDINIT
000013EA                           896  ; INITIALIZE THE GRID AS FOLLOWS:
000013EA                           897  ; * POINTS THE SOURCE GRID POINTER TO GRDMATR0.
000013EA                           898  ; * POINTS THE DESTINATION GRID POINTER TO GRDMATR1.
000013EA                           899  ; * RESETS THE COUNTERS (GRDNPLR1, GRDNPLR2, GRDNGEN).
000013EA                           900  ; * FILLS THE TWO MATRICES (GRDMATR0 AND GRDMATR1) WITH ZEROS.
000013EA                           901  ; INPUT    : NONE
000013EA                           902  ; OUTPUT   : NONE
000013EA                           903  ; MODIFIES : NONE
000013EA                           904  ; -----------------------------------------------------------------------------
000013EA  48E7 8080                905              MOVEM.L A0/D0,-(A7)
000013EE  23FC 00001B18 00001B10   906              MOVE.L  #GRDMATR0,(GRDSRC)
000013F8  23FC 00002318 00001B14   907              MOVE.L  #GRDMATR1,(GRDDST)
00001402  4279 00002B18            908              CLR.W   (GRDNPLR1)
00001408  4279 00002B1A            909              CLR.W   (GRDNPLR2)
0000140E  4279 00002B1C            910              CLR.W   (GRDNGEN)
00001414  41F9 00001B18            911              LEA     GRDMATR0,A0
0000141A  303C 0FFF                912              MOVE.W  #GRDWIDTH*GRDHEIGH*2-1,D0
0000141E  4218                     913  .LOOP       CLR.B   (A0)+
00001420  51C8 FFFC                914              DBRA.W  D0,.LOOP
00001424  4CDF 0101                915              MOVEM.L (A7)+,A0/D0
00001428  4E75                     916              RTS
0000142A                           917  
0000142A                           918  ; -----------------------------------------------------------------------------
0000142A                           919  GRDMUPD
0000142A                           920  ; GRID UPDATE USING MOUSE. THE INTERFACE IS AS FOLLOWS:
0000142A                           921  ; * IF MOUSE IS NOT PRESSED OR IS OUTSIDE THE PLOTTED GRID, DOES NOTHING.
0000142A                           922  ; * IF LEFT MOUSE BUTTON IS PRESSED INSIDE THE GRID:
0000142A                           923  ;   - A PLAYER 1 (VALUE=1) CELL IS CREATED AT THE MOUSE POSITION IF THE MOUSE
0000142A                           924  ;     IS ON THE LEFT HALF OF THE GRID.
0000142A                           925  ;   - A PLAYER 2 (VALUE=2) CELL IS CREATED AT THE MOUSE POSITION IF THE MOUSE
0000142A                           926  ;     IS ON THE RIGHT HALF OF THE GRID.
0000142A                           927  ; * IF RIGHT MOUSE BUTTON IS PRESSED INSIDE THE GRID, THE CELL WHERE THE MOUSE
0000142A                           928  ;   IS IS CLEARED (VALUE=0).
0000142A                           929  ; INPUT    : NONE
0000142A                           930  ; OUTPUT   : NONE
0000142A                           931  ; MODIFIES : NONE
0000142A                           932  ; -----------------------------------------------------------------------------
0000142A                           933  
0000142A                           934  ; TODO : PLACE YOUR CODE HERE
0000142A                           935  ;D0:X ->COLUMNA , D1:Y->FILA , D2:MOUVAL, D3:NUM CASILLA
0000142A  48E7 F880                936              MOVEM.L D0-D4/A0,-(A7)
0000142E  4280                     937              CLR.L D0
00001430  4282                     938              CLR.L D2
00001432  4281                     939              CLR.L D1
00001434  1639 00001AD0            940              MOVE.B (MOUVAL),D3
0000143A  B63C 0000                941              CMP.B #0,D3
0000143E  6700 008C                942              BEQ .FINAL
00001442                           943   ;COMPROBAMOS SI EL MOUSE ESTA DENTRO DE LA MATRIZ          
00001442  3239 00001ACE            944              MOVE.W (MOUX),D1
00001448  B27C 0010                945              CMP.W #GRDXOFF,D1
0000144C  6F00 007E                946              BLE .FINAL
00001450  0441 0010                947              SUB.W #GRDXOFF,D1
00001454  B27C 0300                948              CMP.W #GRDPXWID,D1
00001458  6C00 0072                949              BGE .FINAL
0000145C  3439 00001ACC            950              MOVE.W (MOUY),D2
00001462  B47C 009E                951              CMP.W #GRDYOFF,D2
00001466  6F00 0064                952              BLE .FINAL
0000146A  0442 009E                953              SUB.W #GRDYOFF,D2
0000146E  B47C 0180                954              CMP.W #GRDPXHEI,D2
00001472                           955              
00001472  6C00 0058                956              BGE .FINAL
00001476                           957              
00001476  83FC 000C                958              DIVS.W #GRDSZCEL,D1
0000147A  85FC 000C                959              DIVS.W #GRDSZCEL,D2
0000147E  41F9 00001B14            960              LEA GRDDST,A0
00001484  3002                     961              MOVE.W D2,D0
00001486  C1FC 0040                962              MULS.W #GRDWIDTH,D0
0000148A  D041                     963              ADD.W D1,D0
0000148C  C63C 0001                964              AND.B #MOUMSKLF,D3
00001490  6700 0036                965              BEQ .R_GRID
00001494  1801                     966              MOVE.B D1,D4
00001496  89FC 0020                967              DIVS.W #GRDWIDTH/2,D4
0000149A  5204                     968              ADDQ.B #1,D4
0000149C  1184 0000                969              MOVE.B D4,(A0,D0)
000014A0  B83C 0001                970              CMP.B #1,D4
000014A4  6600 000E                971              BNE .P1
000014A8  5279 00002B18            972              ADD.W #1,(GRDNPLR1)
000014AE  4EF9 000014CC            973              JMP .FINAL
000014B4                           974  .P1         
000014B4  B83C 0002                975              CMP.B #2,D4
000014B8  6600 0012                976              BNE .FINAL
000014BC  5279 00002B1A            977              ADD.W #1,(GRDNPLR2)
000014C2  4EF9 000014CC            978              JMP .FINAL
000014C8                           979              
000014C8  4230 0000                980  .R_GRID: CLR.B (A0,D0)
000014CC                           981   
000014CC                           982  
000014CC                           983              
000014CC                           984  
000014CC  4CDF 011F                985  .FINAL:   MOVEM.L (A7)+,D0-D4/A0
000014D0  4E75                     986            RTS
000014D2                           987  ; -----------------------------------------------------------------------------
000014D2                           988  GRDRUPD
000014D2                           989  ; UPDATES THE GRID ACCORDING TO 2-PLAYER GAME OF LIFE RULES AS FOLLOWS:
000014D2                           990  ; * ADDS 1 TO THE NUMBER OF GENERATIONS (GRDNGEN)
000014D2                           991  ; * SWITCHES THE MATRIX POINTERS (GRDDST AND GRDSRC).
000014D2                           992  ; * CHECKS THE NEIGHBORS USING THE NEW SOURCE MATRIX (POINTER BY GRDDRC)
000014D2                           993  ; * THE RESULTS OF APPLYING THE RULES ARE WRITTEN INTO THE NEW DESTINATION
000014D2                           994  ;   MATRIX (POINTED BY GRDDST).
000014D2                           995  ; * THE RULES ARE THE FOLLOWING, WHERE P1 AND P2 ARE 1 AND 2 RESPECTIVELY,
000014D2                           996  ;   DEAD CELLS ARE REPRESENTED BY 0 AND NP1 AND NP2 DENOTE THE NUMBER OF
000014D2                           997  ;   PLAYER 1 AND PLAYER 2 NEIGHBORS RESPECTIVELY:
000014D2                           998  ;   + SURVIVAL RULES
000014D2                           999  ;     - IF CELL IS P1 AND NP1-NP2 IS 2 OR 3 -> NEW VALUE IS P1
000014D2                          1000  ;     - IF CELL IS P1 AND NP1-NP2 IS 1 AND NP1>=2 -> NEW VALUE IS P1
000014D2                          1001  ;     - OTHERWISE -> NEW VALUE IS 0
000014D2                          1002  ;     - IF CELL IS P2 AND NP2-NP1 IS 2 OR 3 -> NEW VALUE IS P2
000014D2                          1003  ;     - IF CELL IS P2 AND NP2-NP1 IS 1 AND NP2>=2 -> NEW VALUE IS P2
000014D2                          1004  ;     - OTHERWISE -> NEW VALUE IS 0
000014D2                          1005  ;   + BIRTH RULES
000014D2                          1006  ;     - THE CELL HAS EXACTLY THREE P1 NEIGHBOURS AND THE NUMBER
000014D2                          1007  ;       OF P2 NEIGHBOURS IS DIFFERENT FROM THREE. IN THIS CASE A
000014D2                          1008  ;       P1 TOKEN IS BORN IN THE CELL.
000014D2                          1009  ;     - THE CELL HAS EXACTLY THREE P2 NEIGHBOURS AND THE NUMBER
000014D2                          1010  ;       OF P1 NEIGHBOURS IS DIFFERENT FROM THREE. IN THIS CASE A
000014D2                          1011  ;       P2 TOKEN IS BORN IN THE CELL.
000014D2                          1012  ;     - THE CELL HAS EXACTLY THREE WHITE AND THREE BLACK NEIGHBOURS.
000014D2                          1013  ;       IN THIS CASE AN UNBIASED COIN DETERMINES WHETHER A WHITE OR
000014D2                          1014  ;       BLACK TOKEN IS BORN IN THE CELL.
000014D2                          1015  ; INPUT    : NONE
000014D2                          1016  ; OUTPUT   : NONE
000014D2                          1017  ; MODIFIES : NONE
000014D2                          1018  ; -----------------------------------------------------------------------------
000014D2                          1019  
000014D2                          1020  ; TODO : PLACE YOUR CODE HERE
000014D2                          1021  ;D0:COLUMNA VECINO, D1:CONTADOR ITERACION, D2:CELL VALUE, D3:NP1 ,D4:NP2, D5:FILA VECINA, 
000014D2                          1022  ;D6:AUXILIAR PARA MOVIMIENTOS, D7:NUM CASILLAS
000014D2  48E7 FF80               1023          MOVEM.L D0-D7/A0,-(A7)
000014D6                          1024          
000014D6  5279 00002B1C           1025          ADDQ.W #1,(GRDNGEN)
000014DC  227C 00001B14           1026          MOVE.L #GRDDST,A1
000014E2  23FC 00001B10 00001B14  1027          MOVE.L #GRDSRC,(GRDDST)
000014EC  23C9 00001B10           1028          MOVE.L A1,(GRDSRC)
000014F2                          1029          
000014F2  207C 00001B10           1030          MOVE.L #GRDSRC,A0
000014F8                          1031          
000014F8  4241                    1032          CLR D1
000014FA  323C FFFF               1033          MOVE.W #$FFFFFFFF,D1
000014FE                          1034          
000014FE  3C3C 0040               1035          MOVE.W #GRDWIDTH,D6
00001502  CCFC 0020               1036          MULU #GRDHEIGH,D6
00001506  5346                    1037          SUB.W #1,D6
00001508                          1038          
00001508                          1039  .BUCLE:
00001508                          1040        
00001508                          1041  
00001508                          1042  .FINAL:
00001508  4CDF 01FF               1043          MOVEM.L (A7)+,D0-D7/A0
0000150C  4E75                    1044          RTS
0000150E                          1045          
0000150E  =0000003F               1046  NOT_32   EQU %0111111
0000150E  =0000007F               1047  NOT_64   EQU %01111111 ;PARA HACER EL MODULO DE 64
0000150E  =000007FF               1048  NOT_2048 EQU %011111111111 ;PARA HACER EL MODULO DE 2048
0000150E                          1049  
0000150E                          1050  ; -----------------------------------------------------------------------------
0000150E                          1051  GRDSAVE
0000150E                          1052  ; SAVES THE GRID INTO A FILE IN CSV FORMAT
0000150E                          1053  ; INPUT    : NONE
0000150E                          1054  ; OUTPUT   : NONE
0000150E                          1055  ; MODIFIES : NONE
0000150E                          1056  ; NOTE     : THE LOCAL BUFFER SIZE MUST BE MAX(512,2*GRDWIDTH+1). PLEASE CHANGE
0000150E                          1057  ;            IT ACCORDINGLY IF GRDWIDTH*2+1 IS LARGER THAN 512.
0000150E                          1058  ; -----------------------------------------------------------------------------
0000150E  48E7 FFFE               1059              MOVEM.L D0-D7/A0-A6,-(A7)       ; TO BE OPTIMIZED
00001512  103C 0032               1060              MOVE.B  #50,D0                  ; CLOSE ALL FILES (RECOMMENDED)
00001516  4E4F                    1061              TRAP    #15
00001518  9FFC 00000200           1062              SUB.L   #512,A7                 ; ROW BUFFER IN LOCAL MEMORY
0000151E  103C 003A               1063              MOVE.B  #58,D0                  ; SHOW FILE DIALOG TASK
00001522  7201                    1064              MOVE.L  #1,D1                   ; DISPLAY SAVE DIALOG
00001524  43F9 0000159A           1065              LEA     .MSG,A1                 ; STANDARD MESSAGE
0000152A  45F9 000015B4           1066              LEA     .FILTER,A2              ; NO FILTER
00001530  264F                    1067              MOVE.L  A7,A3                   ; FILE NAME BUFFER
00001532  4253                    1068              CLR.W   (A3)                    ; ENSURE THERE IS NO STRING
00001534  4E4F                    1069              TRAP    #15
00001536  4A01                    1070              TST.B   D1
00001538  6700 0054               1071              BEQ     .END                    ; IF CANCELLED, DO NOTHING
0000153C  224B                    1072              MOVE.L  A3,A1                   ; PLACE THE FILENAME INTO A1
0000153E  103C 0034               1073              MOVE.B  #52,D0                  ; CREATE NEW FILE
00001542  4E4F                    1074              TRAP    #15
00001544  4A40                    1075              TST.W   D0                      ; CHECK CREATION ERROR
00001546  6600 0046               1076              BNE     .END                    ; DO NOTHING MORE IF ERROR
0000154A  2C4F                    1077              MOVE.L  A7,A6                   ; PUT A6 INTO START OF BUFFER
0000154C  224F                    1078              MOVE.L  A7,A1                   ; PUT A1 INTO START OF BUFFER
0000154E  41F9 00001B14           1079              LEA GRDDST, A0                  ; A0: POINTER TO THE DATA TO WRITE
00001554  363C 001F               1080              MOVE.W  #GRDHEIGH-1,D3          ; D3: NUMBER OF ROWS - 1
00001558  343C 003F               1081  .LOOPY      MOVE.W  #GRDWIDTH-1,D2          ; D2: NUMBER OF COLUMNS - 1
0000155C  103C 0030               1082  .LOOP       MOVE.B  #'0',D0                 ; ADD CHAR '0' AND THE CELL VALUE
00001560  D018                    1083              ADD.B   (A0)+,D0
00001562  1CC0                    1084              MOVE.B  D0, (A6)+               ; STORE IT IN THE BUFFER
00001564  1CFC 002C               1085              MOVE.B  #',',(A6)+              ; NOW PUT THE COMMA
00001568  51CA FFF2               1086              DBRA.W  D2,.LOOP
0000156C  1D7C 000D FFFF          1087              MOVE.B  #$0D,-1(A6)             ; STORE CARRIAGE RETURN (REMOVE ',')
00001572  1CBC 000A               1088              MOVE.B  #$0A,(A6)               ; STORE LINE FEED
00001576  103C 0036               1089              MOVE.B  #54,D0                  ; WRITE TO FILE TASK NUMBER
0000157A  243C 00000081           1090              MOVE.L  #GRDWIDTH*2+1,D2        ; NUMBER OF BYTES TO WRITE
00001580  4E4F                    1091              TRAP    #15                     ; WRITE (A1 IS ALREADY THERE)
00001582  2C49                    1092              MOVE.L  A1,A6                   ; GO BACK TO THE BUFFER START
00001584  51CB FFD2               1093              DBRA.W  D3,.LOOPY
00001588  103C 0038               1094              MOVE.B  #56,D0                  ; CLOSE FILE
0000158C  4E4F                    1095              TRAP    #15
0000158E  DFFC 00000200           1096  .END        ADD.L   #512,A7                 ; RESTORE STACK
00001594  4CDF 7FFF               1097              MOVEM.L (A7)+,D0-D7/A0-A6       ; TO BE OPTIMIZED
00001598  4E75                    1098              RTS
0000159A= 53 45 4C 45 43 54 ...   1099  .MSG        DC.B    'SELECT A CSV FILE TO SAVE',0
000015B4= 2A 2E 43 53 56 00       1100  .FILTER     DC.B    '*.CSV',0
000015BA                          1101              DS.W    0
000015BA                          1102  
000015BA                          1103  ; -----------------------------------------------------------------------------
000015BA                          1104  GRDLOAD
000015BA                          1105  ; LOADS THE GRID FROM A CSV FORMATTED FILE
000015BA                          1106  ; INPUT    : NONE
000015BA                          1107  ; OUTPUT   : NONE
000015BA                          1108  ; MODIFIES : NONE
000015BA                          1109  ; NOTE     : THE LOCAL BUFFER SIZE MUST BE MAX(512,2*GRDWIDTH+1). PLEASE CHANGE
000015BA                          1110  ;            IT ACCORDINGLY IF GRDWIDTH*2+1 IS LARGER THAN 512.
000015BA                          1111  ; -----------------------------------------------------------------------------
000015BA  48E7 FFFE               1112              MOVEM.L D0-D7/A0-A6,-(A7)       ; TO BE OPTIMIZED
000015BE  103C 0032               1113              MOVE.B  #50,D0                  ; CLOSE ALL FILES (RECOMMENDED)
000015C2  4E4F                    1114              TRAP    #15
000015C4  9FFC 00000200           1115              SUB.L   #512,A7                 ; ROW BUFFER IN LOCAL MEMORY
000015CA  103C 003A               1116              MOVE.B  #58,D0                  ; SHOW FILE DIALOG TASK
000015CE  4281                    1117              CLR.L   D1                      ; DISPLAY LOAD DIALOG
000015D0  43F9 0000163A           1118              LEA     .MSG,A1                 ; STANDARD MESSAGE
000015D6  45F9 00001654           1119              LEA     .FILTER,A2              ; NO FILTER
000015DC  264F                    1120              MOVE.L  A7,A3                   ; FILE NAME BUFFER
000015DE  4253                    1121              CLR.W   (A3)                    ; ENSURE THERE IS NO STRING
000015E0  4E4F                    1122              TRAP    #15
000015E2  4A01                    1123              TST.B   D1
000015E4  6700 0048               1124              BEQ     .END                    ; IF CANCELLED, DO NOTHING
000015E8  224B                    1125              MOVE.L  A3,A1                   ; PLACE THE FILENAME INTO A1
000015EA  103C 0033               1126              MOVE.B  #51,D0                  ; OPEN EXISTING FILE
000015EE  4E4F                    1127              TRAP    #15
000015F0  4A40                    1128              TST.W   D0                      ; CHECK ERRORS
000015F2  6600 003A               1129              BNE     .END                    ; IF ERRORS, DO NOTHING MORE
000015F6  2C4F                    1130              MOVE.L  A7,A6                   ; PUT A6 INTO START OF BUFFER
000015F8  224F                    1131              MOVE.L  A7,A1                   ; PUT A1 INTO START OF BUFFER
000015FA  41F9 00001B14           1132              LEA GRDDST, A0                  ; POINTER TO STORE PROCESS. DATA
00001600  363C 001F               1133              MOVE.W  #GRDHEIGH-1,D3
00001604  224E                    1134  .LOOP       MOVE.L  A6,A1
00001606  103C 0035               1135              MOVE.B  #53,D0                  ; READ DATA TASK NUMBER
0000160A  243C 00000081           1136              MOVE.L  #GRDWIDTH*2+1,D2        ; NUMBER OF BYTES TO READ
00001610  4E4F                    1137              TRAP    #15                     ; READ THE DATA
00001612  343C 003F               1138              MOVE.W  #GRDWIDTH-1,D2
00001616  1019                    1139  .COPY       MOVE.B  (A1)+,D0                ; PICK ONE LOADED CHARACTER
00001618  0400 0030               1140              SUB.B   #'0',D0                 ; CONVERT FROM ASCII TO NUMBER
0000161C  10C0                    1141              MOVE.B  D0,(A0)+                ; STORE DATA
0000161E  5289                    1142              ADDQ.L  #1,A1                   ; SKIP THE COMMA
00001620  51CA FFF4               1143              DBRA.W  D2,.COPY
00001624  51CB FFDE               1144              DBRA.W  D3,.LOOP
00001628  103C 0038               1145              MOVE.B  #56,D0                  ; CLOSE FILE
0000162C  4E4F                    1146              TRAP    #15
0000162E  DFFC 00000200           1147  .END        ADD.L   #512,A7                 ; RESTORE STACK
00001634  4CDF 7FFF               1148              MOVEM.L (A7)+,D0-D7/A0-A6       ; TO BE OPTIMIZED
00001638  4E75                    1149              RTS
0000163A= 53 45 4C 45 43 54 ...   1150  .MSG        DC.B    'SELECT A CSV FILE TO LOAD',0
00001654= 2A 2E 43 53 56 00       1151  .FILTER     DC.B    '*.CSV',0
0000165A                          1152              DS.W    0
0000165A                          1153  
0000165A                          1154  ; -----------------------------------------------------------------------------
0000165A                          1155  GRDLLEFT
0000165A                          1156  ; LOADS THE LEFT PART OF THE GRID FROM A CSV FORMATTED FILE
0000165A                          1157  ; INPUT    : NONE
0000165A                          1158  ; OUTPUT   : NONE
0000165A                          1159  ; MODIFIES : NONE
0000165A                          1160  ; NOTE     : THE LOCAL BUFFER SIZE MUST BE MAX(512,2*GRDWIDTH+1). PLEASE CHANGE
0000165A                          1161  ;            IT ACCORDINGLY IF GRDWIDTH*2+1 IS LARGER THAN 512.
0000165A                          1162  ; NOTE     : ALL THE ACTIVE CELLS ARE STORED AS PLAYER 1 INDEPENDLY OF THEIR
0000165A                          1163  ;            ACTUAL VALUE.
0000165A                          1164  ; -----------------------------------------------------------------------------
0000165A                          1165  
0000165A  48E7 FFFE               1166              MOVEM.L D0-D7/A0-A6,-(A7)       ; TO BE OPTIMIZED
0000165E  103C 0032               1167              MOVE.B  #50,D0                  ; CLOSE ALL FILES (RECOMMENDED)
00001662  4E4F                    1168              TRAP    #15
00001664  9FFC 00000200           1169              SUB.L   #512,A7                 ; ROW BUFFER IN LOCAL MEMORY
0000166A  103C 003A               1170              MOVE.B  #58,D0                  ; SHOW FILE DIALOG TASK
0000166E  4281                    1171              CLR.L   D1                      ; DISPLAY LOAD DIALOG
00001670  43F9 000016EC           1172              LEA     .MSG,A1                 ; STANDARD MESSAGE
00001676  45F9 0000170B           1173              LEA     .FILTER,A2              ; NO FILTER
0000167C  264F                    1174              MOVE.L  A7,A3                   ; FILE NAME BUFFER
0000167E  4253                    1175              CLR.W   (A3)                    ; ENSURE THERE IS NO STRING
00001680  4E4F                    1176              TRAP    #15
00001682  4A01                    1177              TST.B   D1
00001684  6700 005A               1178              BEQ     .END                    ; IF CANCELLED, DO NOTHING
00001688  224B                    1179              MOVE.L  A3,A1                   ; PLACE THE FILENAME INTO A1
0000168A  103C 0033               1180              MOVE.B  #51,D0                  ; OPEN EXISTING FILE
0000168E  4E4F                    1181              TRAP    #15
00001690  4A40                    1182              TST.W   D0                      ; CHECK ERRORS
00001692  6600 004C               1183              BNE     .END                    ; IF ERRORS, DO NOTHING MORE
00001696  2C4F                    1184              MOVE.L  A7,A6                   ; PUT A6 INTO START OF BUFFER
00001698  224F                    1185              MOVE.L  A7,A1                   ; PUT A1 INTO START OF BUFFER
0000169A  41F9 00001B14           1186              LEA GRDDST, A0                  ; POINTER TO STORE PROCESS. DATA
000016A0  363C 001F               1187              MOVE.W  #GRDHEIGH-1,D3
000016A4  224E                    1188  .LOOP       MOVE.L  A6,A1
000016A6  103C 0035               1189              MOVE.B  #53,D0                  ; READ DATA TASK NUMBER
000016AA  243C 00000081           1190              MOVE.L  #GRDWIDTH*2+1,D2        ; NUMBER OF BYTES TO READ
000016B0  4E4F                    1191              TRAP    #15                     ; READ THE DATA
000016B2  343C 003F               1192              MOVE.W  #GRDWIDTH-1,D2
000016B6  1019                    1193  .COPY       MOVE.B  (A1)+,D0                ; PICK ONE LOADED CHARACTER
000016B8  0400 0030               1194              SUB.B   #'0',D0                 ; CONVERT FROM ASCII TO NUMBER
000016BC  B03C 0002               1195              CMP.B #2,D0
000016C0  6600 000C               1196              BNE .CONTINUAR
000016C4  10FC 0000               1197              MOVE.B #0,(A0)+
000016C8  4EF9 000016D0           1198              JMP .CLEAR
000016CE                          1199  .CONTINUAR            
000016CE  10C0                    1200              MOVE.B  D0,(A0)+                ; STORE DATA
000016D0                          1201  .CLEAR            
000016D0  5289                    1202              ADDQ.L  #1,A1                   ; SKIP THE COMMA
000016D2  51CA FFE2               1203              DBRA.W  D2,.COPY
000016D6  51CB FFCC               1204              DBRA.W  D3,.LOOP
000016DA  103C 0038               1205              MOVE.B  #56,D0                  ; CLOSE FILE
000016DE  4E4F                    1206              TRAP    #15
000016E0  DFFC 00000200           1207  .END        ADD.L   #512,A7                 ; RESTORE STACK
000016E6  4CDF 7FFF               1208              MOVEM.L (A7)+,D0-D7/A0-A6       ; TO BE OPTIMIZED
000016EA  4E75                    1209              RTS
000016EC= 53 45 4C 45 43 54 ...   1210  .MSG        DC.B    'SELECT A CSV FILE LEFT TO LOAD',0
0000170B= 2A 2E 43 53 56 00       1211  .FILTER     DC.B    '*.CSV',0
00001712                          1212              DS.W    0
00001712                          1213  
00001712                          1214  
00001712                          1215  
00001712                          1216  
00001712                          1217  
00001712                          1218  
00001712                          1219  
00001712                          1220  
00001712                          1221  
00001712                          1222  
00001712                          1223  
00001712                          1224  
00001712                          1225  
00001712                          1226  ; -----------------------------------------------------------------------------
00001712                          1227  GRDLRGT
00001712                          1228  ; LOADS THE RIGHT PART OF THE GRID FROM A CSV FORMATTED FILE
00001712                          1229  ; INPUT    : NONE
00001712                          1230  ; OUTPUT   : NONE
00001712                          1231  ; MODIFIES : NONE
00001712                          1232  ; NOTE     : THE LOCAL BUFFER SIZE MUST BE MAX(512,2*GRDWIDTH+1). PLEASE CHANGE
00001712                          1233  ;            IT ACCORDINGLY IF GRDWIDTH*2+1 IS LARGER THAN 512.
00001712                          1234  ; NOTE     : ALL THE ACTIVE CELLS ARE STORED AS PLAYER 2 INDEPENDLY OF THEIR
00001712                          1235  ;            ACTUAL VALUE.
00001712                          1236  ; -----------------------------------------------------------------------------
00001712                          1237  
00001712  48E7 FFFE               1238              MOVEM.L D0-D7/A0-A6,-(A7)       ; TO BE OPTIMIZED
00001716  103C 0032               1239              MOVE.B  #50,D0                  ; CLOSE ALL FILES (RECOMMENDED)
0000171A  4E4F                    1240              TRAP    #15
0000171C  9FFC 00000200           1241              SUB.L   #512,A7                 ; ROW BUFFER IN LOCAL MEMORY
00001722  103C 003A               1242              MOVE.B  #58,D0                  ; SHOW FILE DIALOG TASK
00001726  4281                    1243              CLR.L   D1                      ; DISPLAY LOAD DIALOG
00001728  43F9 000017A4           1244              LEA     .MSG,A1                 ; STANDARD MESSAGE
0000172E  45F9 000017C3           1245              LEA     .FILTER,A2              ; NO FILTER
00001734  264F                    1246              MOVE.L  A7,A3                   ; FILE NAME BUFFER
00001736  4253                    1247              CLR.W   (A3)                    ; ENSURE THERE IS NO STRING
00001738  4E4F                    1248              TRAP    #15
0000173A  4A01                    1249              TST.B   D1
0000173C  6700 005A               1250              BEQ     .END                    ; IF CANCELLED, DO NOTHING
00001740  224B                    1251              MOVE.L  A3,A1                   ; PLACE THE FILENAME INTO A1
00001742  103C 0033               1252              MOVE.B  #51,D0                  ; OPEN EXISTING FILE
00001746  4E4F                    1253              TRAP    #15
00001748  4A40                    1254              TST.W   D0                      ; CHECK ERRORS
0000174A  6600 004C               1255              BNE     .END                    ; IF ERRORS, DO NOTHING MORE
0000174E  2C4F                    1256              MOVE.L  A7,A6                   ; PUT A6 INTO START OF BUFFER
00001750  224F                    1257              MOVE.L  A7,A1                   ; PUT A1 INTO START OF BUFFER
00001752  41F9 00001B14           1258              LEA GRDDST, A0                  ; POINTER TO STORE PROCESS. DATA
00001758  363C 001F               1259              MOVE.W  #GRDHEIGH-1,D3
0000175C  224E                    1260  .LOOP       MOVE.L  A6,A1
0000175E  103C 0035               1261              MOVE.B  #53,D0                  ; READ DATA TASK NUMBER
00001762  243C 00000081           1262              MOVE.L  #GRDWIDTH*2+1,D2        ; NUMBER OF BYTES TO READ
00001768  4E4F                    1263              TRAP    #15                     ; READ THE DATA
0000176A  343C 003F               1264              MOVE.W  #GRDWIDTH-1,D2
0000176E  1019                    1265  .COPY       MOVE.B  (A1)+,D0                ; PICK ONE LOADED CHARACTER
00001770  0400 0030               1266              SUB.B   #'0',D0                 ; CONVERT FROM ASCII TO NUMBER
00001774  B03C 0001               1267              CMP.B #1,D0
00001778  6600 000C               1268              BNE .CONTINUAR
0000177C  10FC 0000               1269              MOVE.B #0,(A0)+
00001780  4EF9 00001788           1270              JMP .CLEAR
00001786                          1271  .CONTINUAR            
00001786  10C0                    1272              MOVE.B  D0,(A0)+                ; STORE DATA
00001788                          1273  .CLEAR            
00001788  5289                    1274              ADDQ.L  #1,A1                   ; SKIP THE COMMA
0000178A  51CA FFE2               1275              DBRA.W  D2,.COPY
0000178E  51CB FFCC               1276              DBRA.W  D3,.LOOP
00001792  103C 0038               1277              MOVE.B  #56,D0                  ; CLOSE FILE
00001796  4E4F                    1278              TRAP    #15
00001798  DFFC 00000200           1279  .END        ADD.L   #512,A7                 ; RESTORE STACK
0000179E  4CDF 7FFF               1280              MOVEM.L (A7)+,D0-D7/A0-A6       ; TO BE OPTIMIZED
000017A2  4E75                    1281              RTS
000017A4= 53 45 4C 45 43 54 ...   1282  .MSG        DC.B    'SELECT A CSV FILE LEFT TO LOAD',0
000017C3= 2A 2E 43 53 56 00       1283  .FILTER     DC.B    '*.CSV',0
000017CA                          1284              DS.W    0
000017CA                          1285  
000017CA                          1286  ; -----------------------------------------------------------------------------
000017CA                          1287  GRDPLOT
000017CA                          1288  ; PLOTS THE GRID
000017CA                          1289  ; INPUT    : NONE
000017CA                          1290  ; OUTPUT   : NONE
000017CA                          1291  ; MODIFIES : NONE
000017CA                          1292  ; -----------------------------------------------------------------------------
000017CA                          1293  
000017CA                          1294  ; TODO : PLACE YOUR CODE HERE
000017CA                          1295  
000017CA  48E7 FEF0               1296      MOVEM.L D0-D6/A0-A3, -(A7)
000017CE  41F9 00001B14           1297      LEA GRDDST, A0            ; A0: POINTER TO THE DATA TO WRITE
000017D4  43F9 00002B18           1298      LEA GRDNPLR1, A1
000017DA  45F9 00002B1A           1299      LEA GRDNPLR2, A2
000017E0  4251                    1300      CLR.W (A1)
000017E2  4252                    1301      CLR.W (A2)
000017E4                          1302      
000017E4                          1303      
000017E4                          1304      ;;;;;;;;;;;;;;;;;;
000017E4                          1305      
000017E4                          1306      
000017E4                          1307      ;GRID
000017E4  3A3C 0020               1308      MOVE.W  #GRDHEIGH,D5          ; NUMBER OF ROWS
000017E8  5345                    1309      SUBQ.W #1,D5
000017EA                          1310      
000017EA  3C3C 0040               1311      MOVE.W  #GRDWIDTH,D6          ; NUMBER OF COLUMNS
000017EE  5346                    1312      SUBQ.W #1,D6
000017F0                          1313      
000017F0                          1314      
000017F0                          1315      ;GREEN PEN
000017F0  103C 0050               1316      MOVE.B #80,D0
000017F4  223C 00005500           1317      MOVE.L #CLRDKGRN,D1
000017FA  4E4F                    1318      TRAP #15
000017FC                          1319  
000017FC                          1320    
000017FC                          1321      ;CHANGE WIDTH OF PEN
000017FC  103C 005D               1322      MOVE.B #93,D0
00001800  123C 0002               1323      MOVE.B #2,D1
00001804  4E4F                    1324      TRAP #15
00001806                          1325      
00001806  363C 0010               1326      MOVE.W #GRDXOFF, D3     ;INITIAL POSITION GRID X
0000180A  343C 009E               1327      MOVE.W #GRDYOFF, D2     ;INITIAL POSITION GRID Y
0000180E                          1328      
0000180E                          1329      
0000180E                          1330  .FILA:
0000180E                          1331      
0000180E  1E18                    1332      MOVE.B (A0)+,D7
00001810                          1333     
00001810                          1334      ;CHECK IF IS PLAYER 1'S CELL
00001810  BE7C 0001               1335      CMP #1,D7
00001814  6700 0040               1336      BEQ .PLAYER1
00001818                          1337      ;CHECK IF IS PLAYER 2'S CELL
00001818  BE7C 0002               1338      CMP #2,D7
0000181C  6700 005C               1339      BEQ .PLAYER2
00001820                          1340      ;NO PLAYER
00001820                          1341      
00001820                          1342      ;PAINT RECTANGLE PLAYER 1
00001820                          1343      ;FILL COLOR
00001820  103C 0051               1344      MOVE.B #81,D0
00001824  7200                    1345      MOVE.L #CLRBLACK,D1
00001826  4E4F                    1346      TRAP #15
00001828                          1347      
00001828                          1348      ;DRAW RECTANGLE
00001828  103C 0057               1349      MOVE.B #87,D0
0000182C  3203                    1350      MOVE.W D3,D1
0000182E  3802                    1351      MOVE.W D2,D4    
00001830                          1352      
00001830                          1353      ;STEP FORWARD ONE CELL ON A ROW
00001830  0643 000C               1354      ADD.W #GRDSZCEL,D3
00001834  0644 000C               1355      ADD.W #GRDSZCEL,D4
00001838  4E4F                    1356      TRAP #15
0000183A                          1357      
0000183A                          1358  .LOOP_PLAYER:  
0000183A                          1359  
0000183A                          1360      
0000183A  51CE FFD2               1361      DBRA D6, .FILA
0000183E                          1362      
0000183E  363C 0010               1363      MOVE.W #GRDXOFF,D3            ;INITIAL POSITION GRID X  
00001842                          1364      
00001842                          1365      ;CHANGE ROW
00001842  0642 000C               1366      ADD.W #GRDSZCEL,D2              
00001846                          1367      
00001846  3C3C 0040               1368      MOVE.W  #GRDWIDTH,D6          ; NUMBER OF COLUMNS
0000184A  5346                    1369      SUBQ.W #1,D6
0000184C                          1370      
0000184C  51CD FFC0               1371      DBRA D5, .FILA
00001850  4EF9 0000189E           1372      JMP .FINAL
00001856                          1373  
00001856                          1374  .PLAYER1:
00001856                          1375  
00001856                          1376  
00001856                          1377      ;PAINT RECTANGLE PLAYER 1
00001856                          1378      ;FILL COLOR
00001856  103C 0051               1379      MOVE.B #81,D0
0000185A  223C 00FF0000           1380      MOVE.L #CLRLTBLU,D1
00001860  4E4F                    1381      TRAP #15
00001862                          1382      
00001862                          1383      ;DRAW RECTANGLE
00001862  103C 0057               1384      MOVE.B #87,D0
00001866  3203                    1385      MOVE.W D3,D1
00001868  3802                    1386      MOVE.W D2,D4
0000186A                          1387      
0000186A                          1388      ;STEP FORWARD ONE CELL ON A ROW
0000186A  0643 000C               1389      ADD.W #GRDSZCEL,D3
0000186E  0644 000C               1390      ADD.W #GRDSZCEL,D4
00001872  4E4F                    1391      TRAP #15
00001874                          1392      
00001874                          1393      ;INCREASE PLAYER1 COUNTER
00001874  5251                    1394      ADDQ.W #1, (A1)
00001876  4EF8 183A               1395      JMP .LOOP_PLAYER
0000187A                          1396  
0000187A                          1397  
0000187A                          1398  .PLAYER2:
0000187A                          1399  
0000187A                          1400  
0000187A                          1401      ;PAINT RECTANGLE PLAYER 2
0000187A                          1402      ;FILL COLOR
0000187A  103C 0051               1403      MOVE.B #81,D0
0000187E  223C 000000FF           1404      MOVE.L #CLRLTRED,D1
00001884  4E4F                    1405      TRAP #15
00001886                          1406      
00001886                          1407      
00001886                          1408      ;RECTANGLE
00001886  103C 0057               1409      MOVE.B #87,D0
0000188A  3203                    1410      MOVE.W D3,D1
0000188C  3802                    1411      MOVE.W D2,D4
0000188E                          1412      
0000188E                          1413      ;STEP FORWARD ONE CELL ON A ROW
0000188E  0643 000C               1414      ADD.W #GRDSZCEL,D3
00001892  0644 000C               1415      ADD.W #GRDSZCEL,D4
00001896  4E4F                    1416      TRAP #15
00001898                          1417      
00001898                          1418      ;INCREASE PLAYER1 COUNTER
00001898  5252                    1419      ADDQ.W #1, (A2)
0000189A                          1420      
0000189A  4EF8 183A               1421      JMP .LOOP_PLAYER
0000189E                          1422   
0000189E                          1423            
0000189E                          1424  .FINAL:
0000189E                          1425  
0000189E                          1426      ;CONTADORES
0000189E  103C 0051               1427      MOVE.B #81,D0
000018A2  223C 00FF0000           1428      MOVE.L #CLRLTBLU,D1
000018A8  4E4F                    1429      TRAP #15
000018AA                          1430      
000018AA  103C 005F               1431      MOVE.B #95,D0     
000018AE  323C 0002               1432      MOVE.W #GRDSCP1X,D1
000018B2  343C 0009               1433      MOVE.W #GRDSCP1Y,D2
000018B6  43F9 00002B18           1434      LEA GRDNPLR1,A1
000018BC  4E4F                    1435      TRAP #15
000018BE                          1436      
000018BE  103C 0051               1437      MOVE.B #81,D0
000018C2  223C 000000FF           1438      MOVE.L #CLRLTRED,D1
000018C8  4E4F                    1439      TRAP #15
000018CA                          1440      
000018CA  103C 005F               1441      MOVE.B #95,D0
000018CE  323C 005E               1442      MOVE.W #GRDSCP2X,D1
000018D2  343C 0009               1443      MOVE.W #GRDSCP2Y,D2
000018D6  43F9 00002B1A           1444      LEA GRDNPLR2,A1
000018DC  4E4F                    1445      TRAP #15
000018DE                          1446     
000018DE  103C 0051               1447      MOVE.B #81,D0
000018E2  223C 00005500           1448      MOVE.L #CLRDKGRN,D1
000018E8  4E4F                    1449      TRAP #15
000018EA                          1450      
000018EA  103C 005F               1451      MOVE.B #95,D0
000018EE  323C 0030               1452      MOVE.W #GRDSCNGX,D1
000018F2  343C 0009               1453      MOVE.W #GRDSCNGY,D2
000018F6  43F9 00002B1C           1454      LEA GRDNGEN,A1
000018FC  4E4F                    1455      TRAP #15
000018FE                          1456  
000018FE  4CDF 0F7F               1457      MOVEM.L  (A7)+, D0-D6/A0-A3
00001902  4E75                    1458      RTS
00001904                          1459   
00001904                          1460   
00001904                          1461   
00001904                          1462   
00001904                          1463  
00001904                          1464  
00001904                          1465  
00001904                          1466  
00001904                          1467  
00001904                          1468  
00001904                          1469  
00001904                          1470  
00001904                          1471  
00001904                          1472  
00001904                          1473  
00001904                          1474  
00001904                          1475  
00001904                          1476  
00001904                          1477  
00001904                          1478  
00001904                          1479  
00001904                          1480  
00001904                          1481  -------------------- end include --------------------
00001904                          1482              INCLUDE "GOL.X68"               ; GAME OF LIFE APPLICATION
00001904                          1483  ; =============================================================================
00001904                          1484  ; TITLE    : GAME OF LIFE APPLICATION
00001904                          1485  ; AUTHOR   : ANTONI BURGUERA
00001904                          1486  ; HISTORY  : 05-JULY-2021 - CREATION
00001904                          1487  ; COMMENTS : THIS IS AN APPLICATION. SO, IT IMPLEMENTS INITIALIZATION, UPDATE
00001904                          1488  ;            AND PLOT, AS WELL AS SOME AUXILIARY SUBROUTINES.
00001904                          1489  ; =============================================================================
00001904                          1490  
00001904                          1491  ; -----------------------------------------------------------------------------
00001904                          1492  GOLINIT
00001904                          1493  ; INITIALIZE GAME OF LIFE APPLICATION AS FOLLOWS:
00001904                          1494  ; * MAKES THE INTERNAL STATE TO BE "PAUSED/STOPPED"
00001904                          1495  ; * INITIALIZES THE USER INTERFACE (BY INITIALIZING THE BUTTONS LIST AND
00001904                          1496  ;   ADDING BUTTONS INTO IT)
00001904                          1497  ; * INITIALIZES THE GRID.
00001904                          1498  ; * INITIALIZES THE UTILITY CODE.
00001904                          1499  ; INPUT    : NONE
00001904                          1500  ; OUTPUT   : NONE
00001904                          1501  ; MODIFIES : NONE
00001904                          1502  ; -----------------------------------------------------------------------------
00001904  48E7 FFFE               1503              MOVEM.L D0-D7/A0-A6,-(A7)
00001908  13FC 0000 00002B1E      1504              MOVE.B  #GOLSPAUS,(GOLSTATE)
00001910  4EB8 1350               1505              JSR     BTLINIT
00001914  41F9 0000193A           1506              LEA     .SDBLIST,A0
0000191A  2258                    1507  .LOOP       MOVE.L  (A0)+,A1
0000191C  B3FC FFFFFFFF           1508              CMP.L   #-1,A1
00001922  6700 0008               1509              BEQ     .END
00001926  4EB8 1370               1510              JSR     BTLADD
0000192A  60EE                    1511              BRA     .LOOP
0000192C  4EB8 13EA               1512  .END        JSR     GRDINIT
00001930  4EB8 10DC               1513              JSR     UTLINIT
00001934  4CDF 7FFF               1514              MOVEM.L (A7)+,D0-D7/A0-A6
00001938  4E75                    1515              RTS
0000193A= 00001A16 00001A28 ...   1516  .SDBLIST    DC.L    GOLCLRBT,GOLRUNBT,GOLSTPBT,GOLSTEBT,GOLLLFBT,GOLLRTBT
00001952= 00001A8A 00001AA0 ...   1517              DC.L    GOLLOABT,GOLSAVBT,-1
0000195E                          1518  
0000195E                          1519  ; -----------------------------------------------------------------------------
0000195E                          1520  GOLUPD
0000195E                          1521  ; UPDATE GAME OF LIFE APPLICATION AS FOLLOWS:
0000195E                          1522  ; * UPDATES THE BUTTON LIST
0000195E                          1523  ; * EXECUTES CODE DEPENDING ON THE CURRENT APPLICATION STATE.
0000195E                          1524  ; INPUT    : NONE
0000195E                          1525  ; OUTPUT   : NONE
0000195E                          1526  ; MODIFIES : NONE
0000195E                          1527  ; -----------------------------------------------------------------------------
0000195E  48E7 C0C0               1528              MOVEM.L A0-A1/D0-D1,-(A7)
00001962  4EB8 139A               1529              JSR     BTLUPD
00001966  41F9 00001982           1530              LEA     .JMPTBL,A0
0000196C  4280                    1531              CLR.L   D0
0000196E  1039 00002B1E           1532              MOVE.B  (GOLSTATE),D0
00001974  E508                    1533              LSL.B   #2,D0
00001976  2070 0000               1534              MOVE.L  (A0,D0),A0
0000197A  4E90                    1535              JSR     (A0)
0000197C  4CDF 0303               1536              MOVEM.L (A7)+,A0-A1/D0-D1
00001980  4E75                    1537              RTS
00001982= 0000142A 00001992       1538  .JMPTBL     DC.L    GRDMUPD,GOLDORUN
0000198A                          1539  
0000198A                          1540  ; -----------------------------------------------------------------------------
0000198A                          1541  GOLPLOT
0000198A                          1542  ; PLOTS THE APPLICATION BY CALLING BTLPLOT AND GRDPLOT
0000198A                          1543  ; INPUT    : NONE
0000198A                          1544  ; OUTPUT   : NONE
0000198A                          1545  ; MODIFIES : NONE
0000198A                          1546  ; -----------------------------------------------------------------------------
0000198A  4EB8 13C2               1547              JSR     BTLPLOT
0000198E  4EF8 17CA               1548              JMP     GRDPLOT
00001992                          1549  
00001992                          1550  ; -----------------------------------------------------------------------------
00001992                          1551  GOLDORUN
00001992                          1552  ; EXECUTES THE RUN STATE. IT ALSO CHECKS IF THE MAXIMUM NUMBER OF GENERATIONS
00001992                          1553  ; IS REACHED AND, IF SO, ANNOUNCES THE WINNER.
00001992                          1554  ; INPUT    : NONE
00001992                          1555  ; OUTPUT   : NONE
00001992                          1556  ; MODIFIES : NONE
00001992                          1557  ; -----------------------------------------------------------------------------
00001992  48E7 8040               1558              MOVEM.L D0/A1,-(A7)
00001996  0C79 00FA 00002B1C      1559              CMP.W   #GOLMAXGN,(GRDNGEN)
0000199E  6D00 0034               1560              BLT     .DOIT
000019A2  43F9 000019F4           1561              LEA     .TIE,A1
000019A8  3039 00002B18           1562              MOVE.W  (GRDNPLR1),D0
000019AE  B079 00002B1A           1563              CMP.W   (GRDNPLR2),D0
000019B4  6700 0012               1564              BEQ     .PLAYSOUND
000019B8  43F9 000019DE           1565              LEA     .P1WINS,A1
000019BE  6E00 0008               1566              BGT     .PLAYSOUND
000019C2  43F9 000019E9           1567              LEA     .P2WINS,A1
000019C8  103C 0046               1568  .PLAYSOUND  MOVE.B  #70,D0
000019CC  4E4F                    1569              TRAP    #15
000019CE  4EB9 00001A0C           1570  .NOSOUND    JSR     GOLTOPAU
000019D4  4EB8 14D2               1571  .DOIT       JSR     GRDRUPD
000019D8  4CDF 0201               1572              MOVEM.L (A7)+,D0/A1
000019DC  4E75                    1573              RTS
000019DE= 50 31 57 49 4E 53 ...   1574  .P1WINS     DC.B    'P1WINS.WAV',0
000019E9= 50 32 57 49 4E 53 ...   1575  .P2WINS     DC.B    'P2WINS.WAV',0
000019F4= 54 49 45 2E 57 41 ...   1576  .TIE        DC.B    'TIE.WAV',0
000019FC                          1577              DS.W    0
000019FC                          1578  
000019FC                          1579  ; -----------------------------------------------------------------------------
000019FC                          1580  GOLTORUN
000019FC                          1581  ; SWITCHES TO RUN STATE
000019FC                          1582  ; INPUT    : NONE
000019FC                          1583  ; OUTPUT   : NONE
000019FC                          1584  ; MODIFIES : NONE
000019FC                          1585  ; -----------------------------------------------------------------------------
000019FC  4279 00002B1C           1586              CLR.W   (GRDNGEN)               ; CLEAR GENERATIONS COUNT
00001A02  13FC 0001 00002B1E      1587              MOVE.B  #GOLSEXEC,(GOLSTATE)
00001A0A  4E75                    1588              RTS
00001A0C                          1589  
00001A0C                          1590  ; -----------------------------------------------------------------------------
00001A0C                          1591  GOLTOPAU
00001A0C                          1592  ; SWITCHES TO PAUSE STATE
00001A0C                          1593  ; INPUT    : NONE
00001A0C                          1594  ; OUTPUT   : NONE
00001A0C                          1595  ; MODIFIES : NONE
00001A0C                          1596  ; -----------------------------------------------------------------------------
00001A0C  13FC 0000 00002B1E      1597              MOVE.B  #GOLSPAUS,(GOLSTATE)
00001A14  4E75                    1598              RTS
00001A16                          1599  
00001A16                          1600  ; --- STATIC DATA -------------------------------------------------------------
00001A16                          1601  
00001A16                          1602  ; CLEAR BUTTON SDB
00001A16                          1603  
00001A16= 000A                    1604  GOLCLRBT    DC.W    BTLVEMRG                ; YTOP
00001A18= 000A                    1605              DC.W    0*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A1A= 0028                    1606              DC.W    BTLVERSZ                ; HEIGHT
00001A1C= 00B4                    1607              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A1E                          1608  ; TODO: PLACE THE CALLBACK HERE
00001A1E                          1609              
00001A1E= 000013EA                1610              DC.L   GRDINIT
00001A22                          1611              
00001A22= 43 4C 45 41 52 00       1612              DC.B    'CLEAR',0               ; TEXT
00001A28                          1613              DS.W    0
00001A28                          1614  
00001A28                          1615  ; RUN BUTTON SDB
00001A28                          1616  
00001A28= 000A                    1617  GOLRUNBT    DC.W    BTLVEMRG                ; YTOP
00001A2A= 00D2                    1618              DC.W    1*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A2C= 0028                    1619              DC.W    BTLVERSZ                ; HEIGHT
00001A2E= 00B4                    1620              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A30                          1621  ; TODO: PLACE THE CALLBACK HERE
00001A30= 000019FC                1622              DC.L   GOLTORUN
00001A34= 52 55 4E 00             1623              DC.B    'RUN',0                 ; TEXT
00001A38                          1624              DS.W    0
00001A38                          1625  
00001A38                          1626  ; STOP BUTTON SDB
00001A38                          1627  
00001A38= 000A                    1628  GOLSTPBT    DC.W    BTLVEMRG                ; YTOP
00001A3A= 019A                    1629              DC.W    2*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A3C= 0028                    1630              DC.W    BTLVERSZ                ; HEIGHT
00001A3E= 00B4                    1631              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A40                          1632  ; TODO: PLACE THE CALLBACK HERE
00001A40= 00001A0C                1633              DC.L  GOLTOPAU
00001A44= 53 54 4F 50 00          1634              DC.B    'STOP',0                ; TEXT
00001A4A                          1635              DS.W    0
00001A4A                          1636  
00001A4A                          1637  ; STEP BUTTON SDB
00001A4A                          1638  
00001A4A= 000A                    1639  GOLSTEBT    DC.W    BTLVEMRG                ; YTOP
00001A4C= 0262                    1640              DC.W    3*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A4E= 0028                    1641              DC.W    BTLVERSZ                ; HEIGHT
00001A50= 00B4                    1642              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A52                          1643  ; TODO: PLACE THE CALLBACK HEREÇ
00001A52= 00001992                1644              DC.L GOLDORUN
00001A56= 53 54 45 50 00          1645              DC.B    'STEP',0                ; TEXT
00001A5C                          1646              DS.W    0
00001A5C                          1647  
00001A5C                          1648  ; LOAD LEFT BUTTON SDB
00001A5C                          1649  
00001A5C= 003C                    1650  GOLLLFBT    DC.W    2*BTLVEMRG+BTLVERSZ     ; YTOP
00001A5E= 000A                    1651              DC.W    0*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A60= 0028                    1652              DC.W    BTLVERSZ                ; HEIGHT
00001A62= 00B4                    1653              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A64                          1654  ; TODO: PLACE THE CALLBACK HERE
00001A64= 0000165A                1655              DC.L GRDLLEFT
00001A68= 4C 4F 41 44 20 4C ...   1656              DC.B    'LOAD LEFT',0           ; TEXT
00001A72                          1657              DS.W    0
00001A72                          1658  
00001A72                          1659  ; LOAD RIGHT BUTTON SDB
00001A72                          1660  
00001A72= 003C                    1661  GOLLRTBT    DC.W    2*BTLVEMRG+BTLVERSZ     ; YTOP
00001A74= 00D2                    1662              DC.W    1*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A76= 0028                    1663              DC.W    BTLVERSZ                ; HEIGHT
00001A78= 00B4                    1664              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A7A                          1665  ; TODO: PLACE THE CALLBACK HERE
00001A7A= 00001712                1666              DC.L   GRDLRGT
00001A7E= 4C 4F 41 44 20 52 ...   1667              DC.B    'LOAD RIGHT',0          ; TEXT
00001A8A                          1668              DS.W    0
00001A8A                          1669  
00001A8A                          1670  ; LOAD ALL BUTTON SDB
00001A8A                          1671  
00001A8A= 003C                    1672  GOLLOABT    DC.W    2*BTLVEMRG+BTLVERSZ     ; YTOP
00001A8C= 019A                    1673              DC.W    2*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001A8E= 0028                    1674              DC.W    BTLVERSZ                ; HEIGHT
00001A90= 00B4                    1675              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001A92                          1676  ; TODO: PLACE THE CALLBACK HERE
00001A92= 000015BA                1677              DC.L GRDLOAD 
00001A96= 4C 4F 41 44 20 41 ...   1678              DC.B    'LOAD ALL',0            ; TEXT
00001AA0                          1679              DS.W    0
00001AA0                          1680  
00001AA0                          1681  ; SAVE BUTTON SDB
00001AA0                          1682  
00001AA0= 003C                    1683  GOLSAVBT    DC.W    2*BTLVEMRG+BTLVERSZ     ; YTOP
00001AA2= 0262                    1684              DC.W    3*(SCRWIDTH/4)+BTLHOMRG ; XLEFT
00001AA4= 0028                    1685              DC.W    BTLVERSZ                ; HEIGHT
00001AA6= 00B4                    1686              DC.W    SCRWIDTH/4-2*BTLHOMRG   ; WIDTH
00001AA8                          1687  ; TODO: PLACE THE CALLBACK HERE
00001AA8= 0000150E                1688              DC.L    GRDSAVE
00001AAC= 53 41 56 45 00          1689              DC.B    'SAVE',0          ; TEXT
00001AB2                          1690              DS.W    0
00001AB2                          1691  
00001AB2                          1692  
00001AB2                          1693  
00001AB2                          1694  
00001AB2                          1695  -------------------- end include --------------------
00001AB2                          1696  
00001AB2                          1697  ; --- INITIALIZE --------------------------------------------------------------
00001AB2                          1698  
00001AB2  4EB8 1000               1699  START       JSR     SYSINIT                 ; INITIALIZE SYSTEM CODE
00001AB6  4EB8 1904               1700              JSR     GOLINIT                 ; INITIALIZE GAME OF LIFE
00001ABA                          1701  
00001ABA                          1702  ; --- UPDATE ------------------------------------------------------------------
00001ABA                          1703  
00001ABA  4E41                    1704  .LOOP       TRAP    #MOUTRAP                ; READ MOUSE
00001ABC  4EB8 195E               1705              JSR     GOLUPD                  ; UPDATE APPLICATION
00001AC0                          1706  
00001AC0                          1707  ; --- PLOT --------------------------------------------------------------------
00001AC0                          1708  
00001AC0  4EB8 198A               1709              JSR     GOLPLOT                 ; PLOT APPLICATION
00001AC4  4E40                    1710              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001AC6  60F2                    1711              BRA     .LOOP
00001AC8  FFFF FFFF               1712              SIMHALT
00001ACC                          1713  
00001ACC                          1714  ; --- VARIABLES ---------------------------------------------------------------
00001ACC                          1715  
00001ACC                          1716              INCLUDE "SYSVAR.X68"            ; SYSTEM VARIABLES
00001ACC                          1717  ; =============================================================================
00001ACC                          1718  ; TITLE    : SYSTEM VARS
00001ACC                          1719  ; AUTHOR   : ANTONI BURGUERA
00001ACC                          1720  ; HISTORY  : 05-JULY-2021 - CREATION
00001ACC                          1721  ; COMMENTS : * ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001ACC                          1722  ;              THEY MUST NOT BE IN PROTECTED MEMORY.
00001ACC                          1723  ;
00001ACC                          1724  ;            * SINCE SOME SUBROUTINES TAKE ADVANTAGE OF THE ORDER IN WHICH
00001ACC                          1725  ;              THE VARIABLES ARE IN MEMORY, THEIR ORDER SHOULD NOT BE ALTERED.
00001ACC                          1726  ; =============================================================================
00001ACC                          1727  
00001ACC                          1728  ; --- MOUSE RELATED VARIABLES -------------------------------------------------
00001ACC                          1729  
00001ACC                          1730  MOUY        DS.W    1                       ; MOUSE Y COORDINATE
00001ACE                          1731  MOUX        DS.W    1                       ; MOUSE X COORDINATE
00001AD0                          1732  MOUVAL      DS.B    1                       ; CURRENT MOUSE BUTTON STATUS
00001AD1                          1733  MOUEDGE     DS.B    1                       ; RISING EDGES IN MOUVAL
00001AD2                          1734              DS.W    0
00001AD2                          1735  -------------------- end include --------------------
00001AD2                          1736              INCLUDE "VAR.X68"               ; USER VARIABLES
00001AD2                          1737  ; =============================================================================
00001AD2                          1738  ; TITLE    : USER VARS
00001AD2                          1739  ; AUTHOR   : ANTONI BURGUERA
00001AD2                          1740  ; HISTORY  : 05-JULY-2021 - CREATION
00001AD2                          1741  ; COMMENTS : SEE THE CORRESPONDING FILES (UTIL.X68, BTNLIST.X68, GRID.X68 OR
00001AD2                          1742  ;            GOL.X68) TO LEARN ABOUT THE MEANING OF THESE VARIABLES.
00001AD2                          1743  ; =============================================================================
00001AD2                          1744  
00001AD2                          1745  ; --- UTILITY VARS ------------------------------------------------------------
00001AD2                          1746  
00001AD2                          1747  UTLRNDIX    DS.B    1                       ; RANDOM GENERATOR INDEX
00001AD4                          1748              DS.W    0
00001AD4                          1749  
00001AD4                          1750  ; --- BUTTON LIST -------------------------------------------------------------
00001AD4                          1751  
00001AD4                          1752  BTLDATA     DS.B    BTLMXVDB*BTNSZVDB       ; BUTTONS VDB STORAGE
00001B10                          1753              DS.W    0
00001B10                          1754  
00001B10                          1755  ; --- GRID --------------------------------------------------------------------
00001B10                          1756  
00001B10                          1757  GRDSRC      DS.L    1                       ; SOURCE MATRIX POINTER
00001B14                          1758  GRDDST      DS.L    1                       ; DESTINATION MATRIX POINTER
00001B18                          1759  GRDMATR0    DS.B    GRDWIDTH*GRDHEIGH       ; ONE OF THE GRIDS...
00002318                          1760  GRDMATR1    DS.B    GRDWIDTH*GRDHEIGH       ; THE OTHER GRID
00002B18                          1761  GRDNPLR1    DS.W    1                       ; NUMBER OF PLAYER 1 CELLS
00002B1A                          1762  GRDNPLR2    DS.W    1                       ; NUMBER OF PLAYER 2 CELLS
00002B1C                          1763  GRDNGEN     DS.W    1                       ; NUMOER OF GENERATIONS
00002B1E                          1764  
00002B1E                          1765  ; --- APPLICATION -------------------------------------------------------------
00002B1E                          1766  
00002B1E                          1767  GOLSTATE    DS.B    1                       ; APPLICATION STATE
00002B20                          1768              DS.W    0
00002B20                          1769  -------------------- end include --------------------
00002B20                          1770  
00002B20                          1771              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
BTLADD              1370
BTLADD:END          138E
BTLADD:FOUND        1394
BTLADD:LOOP         137E
BTLCLEAR            1350
BTLDATA             1AD4
BTLHOMRG            A
BTLINIT             1350
BTLINIT:LOOP        135E
BTLMXVDB            A
BTLPLOT             13C2
BTLPLOT:FIN         13E4
BTLPLOT:LOOP        13D0
BTLUPD              139A
BTLUPD:DONE         13BC
BTLUPD:LOOP         13A8
BTLVEMRG            A
BTLVERSZ            28
BTNINIT             1214
BTNPENCL            5500
BTNPENWD            4
BTNPLOT             12B8
BTNPRSCL            6600
BTNSELCL            AA00
BTNSZVDB            6
BTNUPD              121C
BTNUPD:BITC         12A8
BTNUPD:BITI         1278
BTNUPD:BITP         1290
BTNUPD:DINS_Y       1242
BTNUPD:FINAL        12B2
BTNUPD:MAJOR_0_X    125E
BTNUPD:MAJOR_0_Y    126C
CHRHEIGH            10
CHRSHHEI            4
CHRSHWID            3
CHRWIDTH            8
CLRBLACK            0
CLRDKGRN            5500
CLRLTBLU            FF0000
CLRLTGRN            AA00
CLRLTRED            FF
CLRMDGRN            6600
CLRWHITE            FFFFFF
FINAL1              1318
GOLCLRBT            1A16
GOLDORUN            1992
GOLDORUN:DOIT       19D4
GOLDORUN:NOSOUND    19CE
GOLDORUN:P1WINS     19DE
GOLDORUN:P2WINS     19E9
GOLDORUN:PLAYSOUND  19C8
GOLDORUN:TIE        19F4
GOLINIT             1904
GOLINIT:END         192C
GOLINIT:LOOP        191A
GOLINIT:SDBLIST     193A
GOLLLFBT            1A5C
GOLLOABT            1A8A
GOLLRTBT            1A72
GOLMAXGN            FA
GOLPLOT             198A
GOLRUNBT            1A28
GOLSAVBT            1AA0
GOLSEXEC            1
GOLSPAUS            0
GOLSTATE            2B1E
GOLSTEBT            1A4A
GOLSTPBT            1A38
GOLTOPAU            1A0C
GOLTORUN            19FC
GOLUPD              195E
GOLUPD:JMPTBL       1982
GRDCOLP1            FF0000
GRDCOLP2            FF
GRDDST              1B14
GRDHEIGH            20
GRDINIT             13EA
GRDINIT:LOOP        141E
GRDLLEFT            165A
GRDLLEFT:CLEAR      16D0
GRDLLEFT:CONTINUAR  16CE
GRDLLEFT:COPY       16B6
GRDLLEFT:END        16E0
GRDLLEFT:FILTER     170B
GRDLLEFT:LOOP       16A4
GRDLLEFT:MSG        16EC
GRDLOAD             15BA
GRDLOAD:COPY        1616
GRDLOAD:END         162E
GRDLOAD:FILTER      1654
GRDLOAD:LOOP        1604
GRDLOAD:MSG         163A
GRDLRGT             1712
GRDLRGT:CLEAR       1788
GRDLRGT:CONTINUAR   1786
GRDLRGT:COPY        176E
GRDLRGT:END         1798
GRDLRGT:FILTER      17C3
GRDLRGT:LOOP        175C
GRDLRGT:MSG         17A4
GRDMATR0            1B18
GRDMATR1            2318
GRDMSHEI            1F
GRDMSWID            3F
GRDMUPD             142A
GRDMUPD:FINAL       14CC
GRDMUPD:P1          14B4
GRDMUPD:R_GRID      14C8
GRDNGEN             2B1C
GRDNPLR1            2B18
GRDNPLR2            2B1A
GRDPLOT             17CA
GRDPLOT:FILA        180E
GRDPLOT:FINAL       189E
GRDPLOT:LOOP_PLAYER  183A
GRDPLOT:PLAYER1     1856
GRDPLOT:PLAYER2     187A
GRDPXHEI            180
GRDPXWID            300
GRDRUPD             14D2
GRDRUPD:BUCLE       1508
GRDRUPD:FINAL       1508
GRDSAVE             150E
GRDSAVE:END         158E
GRDSAVE:FILTER      15B4
GRDSAVE:LOOP        155C
GRDSAVE:LOOPY       1558
GRDSAVE:MSG         159A
GRDSCNGX            30
GRDSCNGY            9
GRDSCP1X            2
GRDSCP1Y            9
GRDSCP2X            5E
GRDSCP2Y            9
GRDSHHEI            5
GRDSHWID            6
GRDSRC              1B10
GRDSZCEL            C
GRDVEMRG            6E
GRDWIDTH            40
GRDXOFF             10
GRDYOFF             9E
INSIDE              12E4
MOUBITLF            0
MOUBITMD            2
MOUBITRT            1
MOUEDGE             1AD1
MOUINIT             102A
MOUMSKLF            1
MOUMSKMD            4
MOUMSKRT            2
MOUREAD             1058
MOUTRAP             1
MOUVAL              1AD0
MOUX                1ACE
MOUY                1ACC
NOT_2048            7FF
NOT_32              3F
NOT_64              7F
OUT                 1310
PRESSED             12FE
SCRHEIGH            258
SCRINIT             108A
SCRTRAP             0
SCRUPD              10C2
SCRWIDTH            320
START               1AB2
START:LOOP          1ABA
SYSINIT             1000
UTLINIT             10DC
UTLRAND             10F6
UTLRAND:RANDVEC     1114
UTLRNDIX            1AD2
UTLSTRLN            10E4
UTLSTRLN:END        10F2
UTLSTRLN:LOOP       10E8
